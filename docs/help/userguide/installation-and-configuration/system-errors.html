<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../help.css"></head>
<body><h2><a name="System_Errors"></a>System Errors</h2><h4><a name="Introduction"></a>Introduction</h4><p>Dyalog APL will display a System Error Dialog and (normally) terminate in one of two circumstances:</p><ul><li value="1">As a result of the failure of a workspace integrity check</li><li value="2">As a result of a System Exception</li></ul><h4><a name="aplcore"></a>aplcore file</h4><p>In these circumstances, APL saves an
<span class="Name">aplcore</span> file which may be sent to Dyalog for diagnosis. The default name and location of the aplcore file may be specified by the <span class="Parameter">AplCoreName</span> parameter. This parameter may also be used to suppress the generation of the aplcore file.</p><p>From version 13.2 onwards useful information, including (where possible) the SI stack at the point where the aplcore was generated is written to the end of aplcore files; the section begins with the string</p><p>'=================== Interesting Information'.</p><h4><a name="Workspace_Integrity"></a>Workspace Integrity</h4><p>When you <tt>)SAVE</tt> your workspace, Dyalog APL first performs a workspace integrity check. If it detects any discrepancy or violation in the internal structure of your workspace, APL does not overwrite your existing workspace on disk. Instead, it displays the System Error dialog box and saves the workspace, together with diagnostic information, in an aplcore file before terminating.</p><p>A System Error code is displayed in the dialog box and should be reported to Dyalog for diagnosis.</p><p>Note that the internal error that caused the discrepancy could have occurred at any time prior to the execution of <tt>)SAVE</tt> and it may not be possible for Dyalog to identify the cause from this aplcore file. </p><p>If APL is started in debug mode with the <b>–Dc</b>, <b>-Dw</b> or <b>–DW</b> flags, the Workspace Integrity check is performed more frequently, and it is more likely that the resulting aplcore file will contain information that will allow the problem to be identified and corrected. It is also possible to enable or alter the debugging level from within APL using the SetDFlags methods; Dyalog support will direct the use of this feature when necessary.</p><h4><a name="System_Exceptions"></a>System Exceptions</h4><p>Non-specific System Errors are the result of Operating System exceptions that can occur due to a fault in Dyalog APL itself, an error in a Windows or other DLL, or even as a result of a hardware fault. The following system exceptions are separately identified.</p><table><tr><th class="Left">Code</th><th class="Left">Description</th><th class="Left">Suggested Action</th></tr><tr><td>900</td><td>A Paging Fault has occurred</td><td>As the most likely cause is a temporary network fault, recommended course of action is to restart your program.</td></tr><tr><td>990 &amp; 991</td><td>An exception has occurred in the Development or Run-Time DLL.</td><td> </td></tr><tr><td>995</td><td>An exception has occurred in a DLL function called via <tt>⎕NA</tt></td><td>Carefully check your <tt>⎕NA</tt> statement and the arguments that you have passed to the DLL function</td></tr><tr><td>996</td><td>An exception has occurred in a DLL function called via a threaded <tt>⎕NA</tt> call</td><td>As above</td></tr><tr><td>997</td><td>An exception has occurred while processing an incoming OLE call</td><td> </td></tr><tr><td>999</td><td>An exception has been caused by Dyalog APL or by the Operating System</td><td> </td></tr></table><h4><a name="aplcores"></a>Recovering Data from aplcore files</h4><p>Objects may often (but not always) be recovered from aplcore using <tt>)COPY</tt>. Note that because (by default) the aplcore file has no extension, it is necessary to explicitly add a dot, or APL will attempt to find the non-existent file aplcore.DWS, i.e.</p><pre>      )COPY aplcore.</pre><h4><a name="Reporting_Errors"></a>Reporting Errors to Dyalog</h4><p>If APL crashes and saves an aplcore file, please email the following information to support@dyalog.com:</p><ol><li value="1">a brief description of the circumstances surrounding the error</li><li value="2">details of your version of Dyalog APL: the full version number, whether it is Unicode or Classic Edition, and the BuildID.  This information appears in the <span class="Name">Help-&gt;About</span> box; the <span class="Name">Copy</span> button copies this information into the clipboard, from where it can be pasted into an email etc.</li><li value="3">the aplcore file itself</li></ol><p>If the problem is reproducible, i.e. can be easily repeated, please also send the appropriate description, workspace, and other files required to do so.</p><h4><a name="System_Error_Dialog"></a>System Error Dialog Box</h4><p>The System Error Dialog illustrated below was produced by deliberately inducing a system exception in the Windows DLL function <span class="Code">memcpy()</span>. The functions used were:</p><pre>     ∇ foo
[1]    goo
     ∇
     ∇ goo
[1]    hoo
     ∇
     ∇ hoo
[1]    crash
     ∇
 
     ∇ crash
[1]    ⎕NA'dyalog32|MEMCPY u u u'
[2]    MEMCPY 255 255 255
     ∇</pre><pre class="Code"> </pre><p><img src="../images/syserror.png" /></p><h4>Options</h4><table><tr><th class="Left">Item</th><th class="Left">Parameter</th><th class="Left">Description</th></tr><tr><td>Generate complete image core</td><td>CreateAplCoreonSyserror</td><td>Dumps a complete core image with the <span class="Name">User Mode Process Dumper</span> (a Microsoft tool) - see below.</td></tr><tr><td>Create Trappable Error</td><td> </td><td>If you check this box (only enabled on System Error codes 995 and 996), APL will not terminate but will instead generate an error 91 (<tt>EXTERNAL DLL EXCEPTION</tt>) when you press <span class="Name">Dismiss</span>.</td></tr><tr><td>Create an aplcore file</td><td>CreateAplCoreonSyserror</td><td>If this box is checked, an aplcore file will be created.</td></tr><tr><td>Pass exception on to operating system</td><td>PassExceptionsToOpSys</td><td>If this box is checked, the exception will be passed on to your current debugging tool (e.g. <span class="Name">Visual Studio</span>).</td></tr><tr><td>Copy to clipboard</td><td> </td><td>Copies the contents of the APL stack trace window to the Clipboard.</td></tr></table><h4>Generate complete image core</h4><p>The <span class="Name">Generate complete image core</span> option attempts to execute <span class="Code">[SYSDIR]\userdump.exe</span>, where <span class="Code">[SYSDIR]</span> is the windows system directory (typically c:\windows\system32, and <span class="Code">userdump.exe</span> is the User Mode Process Dumper, a Microsoft tool that can be downloaded from the following url (which you may copy from Winhelp and paste into a browser):</p><pre class="Code">http://www.microsoft.com/downloads/details.aspx?
FamilyID=e23cd741-d222-48df-9cd8-28796f414256&amp;DisplayLang=en</pre><p>The process creates a file called dyalog.core in the current directory. This file contains much more debug information than a normal aplcore (and is much larger than an aplcore) and can be sent to Dyalog Limited (zip it first please). Alternatively the file can be loaded into Visual Studio .Net to do your own debugging.</p><h4><a name="Debugging_DLLs"></a>Debugging your own DLLs</h4><p>If you are using Visual Studio, the following procedure should be used to debug your own DLLs when an appropriate Dyalog APL System Error occurs.</p><p>Ensure that the <span class="Name">Pass Exception</span> box is checked, then click on <span class="Name">Dismiss</span> to close the System Error dialog box.</p><p>The system exception dialog box appears. Click on<span class="Name"> Debug</span> to start the process in the Visual Studio debugger.</p><p>After debugging, the system exception dialog box appears again. Click on <span class="Name">Don't send</span> to terminate Windows' exception handling.</p><h4>ErrorOnExternalException Parameter</h4><p>This parameter allows you to prevent APL from displaying the System Error dialog box (and terminating) when an exception caused by an external DLL occurs. The following example illustrates what happens when the functions above are run, but with ErrorOnExternalException set to 1.</p><pre>     ⎕←2 ⎕NQ'.' 'GetEnvironment' 'ErrorOnExternalException'
1
     foo
EXTERNAL DLL EXCEPTION
crash[2] MEMCPY 255 255 255
        ^
     ⎕EN
91
     )SI
crash[2]*
hoo[1]
goo[1]
foo[1]</pre><script src="../../../help.js"></script></body>
</html>