<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../help.css"></head>
<body><h2><a name="RunTime_Applications"></a>Run-Time Applications and Components</h2><p>Using Dyalog APL you may create different types of run-time applications and components. Note that the distribution of run-time applications and components requires a Dyalog APL Run-Time Agreement. Please contact Dyalog or your distributor, or see the Dyalog web page for more information.</p><p>The following table shows a list of distributable components for the two Editions. These are referred to in the remainder of this Chapter by the name shown in the first column of the table. It is essential that you distribute the components that are appropriate for the Edition you are using.</p><table><tr><th class="Left">Name</th><th class="Left">File</th></tr><tr><td class="SubHeading">32-bit Unicode</td><td class="SubHeading">Dyalog APL 14.0 Unicode\</td></tr><tr><td>Run-Time EXE</td><td class="Code">dyalogrt.exe</td></tr><tr><td>Run-Time DLL</td><td class="Code">dyalog140rt_unicode.dll</td></tr><tr><td>Bridge DLL</td><td class="Code">bridge140_unicode.dll</td></tr><tr><td>Dyalog DLL</td><td class="Code">dyalog32.dll</td></tr><tr><td>DyalogProvider DLL</td><td class="Code">dyalogprovider.dll</td></tr><tr><td>DyalogNet DLL</td><td class="Code">dyalognet.dll</td></tr><tr><td>APLScript Compiler</td><td class="Code">dyalogc_unicode.exe</td></tr><tr><td class="SubHeading">32-bit Classic</td><td class="SubHeading">Dyalog APL 14.0 Classic\</td></tr><tr><td>Run-Time EXE</td><td class="Code">dyalogrt.exe</td></tr><tr><td>Run-Time DLL</td><td class="Code">dyalog140rt.dll</td></tr><tr><td>Bridge DLL</td><td class="Code">bridge140.dll</td></tr><tr><td>Dyalog DLL</td><td class="Code">dyalog32.dll</td></tr><tr><td>DyalogProvider DLL</td><td class="Code">dyalogprovider.dll</td></tr><tr><td>DyalogNet DLL</td><td class="Code">dyalognet.dll</td></tr><tr><td>APLScript Compiler</td><td class="Code">dyalogc.exe</td></tr><tr><td class="SubHeading">64-bit Unicode</td><td class="SubHeading">Dyalog APL-64 14.0 Unicode\</td></tr><tr><td>Run-Time EXE</td><td class="Code">dyalogrt.exe</td></tr><tr><td>Run-Time DLL</td><td class="Code">dyalog140_64rt_unicode.dll</td></tr><tr><td>Bridge DLL</td><td class="Code">bridge140-64_unicode.dll</td></tr><tr><td>Dyalog DLL</td><td class="Code">dyalog64.dll</td></tr><tr><td>DyalogProvider DLL</td><td class="Code">dyalogprovider.dll</td></tr><tr><td>DyalogNet DLL</td><td class="Code">dyalognet.dll</td></tr><tr><td>APLScript Compiler</td><td class="Code">dyalogc64_unicode.exe</td></tr><tr><td class="SubHeading">64-bit Classic</td><td class="SubHeading">Dyalog APL-64 14.0 Classic\</td></tr><tr><td>Run-Time EXE</td><td class="Code">dyalogrt.exe</td></tr><tr><td>Run-Time DLL</td><td class="Code">dyalog140_64rt.dll</td></tr><tr><td>Bridge DLL</td><td class="Code">bridge140-64.dll</td></tr><tr><td>Dyalog DLL</td><td class="Code">dyalog64.dll</td></tr><tr><td>DyalogProvider DLL</td><td class="Code">dyalogprovider.dll</td></tr><tr><td>DyalogNet DLL</td><td class="Code">dyalognet.dll</td></tr><tr><td>APLScript Compiler</td><td class="Code">dyalogc64.exe</td></tr></table><h4><a name="Stand_Alone_RunTime"></a>Stand-alone  run-time</h4><p>This is the simplest type of run-time to install. Using the <span class="Name">File/Export</span> menu item on the Session window, you can create a standard Windows executable program file (EXE) which contains your workspace and the Run-Time version of the Dyalog APL interpreter. To distribute your application, you need to supply and install:</p><ol><li value="1">your bound executable (EXE)</li><li value="2">whatever additional files that may be required by your application</li></ol><p>The command-line for your application should simply invoke your EXE, with whatever start-up parameters it may require. Note that your application icon and any start-up parameters for the Run-Time Interpreter are specified and bound with the EXE when you make it.</p><p>If your application uses any component of the Microsoft .Net Framework, you must distribute the Bridge DLL and DyalogNet DLLs. These DLLs must either be on the system path or placed in the same directory as your EXE. If you are going to use your application with ASP.NET, the DLLs must also be installed in the global assembly cache (GAC) using the <span class="Code">gacutil.exe</span> utility program.</p><h4><a name="Bount_RunTime"></a>Bound run-time</h4><p>This option requires the separate installation of the Run-Time DLL, but compared with the stand-alone executable option, may save disk space and memory if your customer installs and runs several different Dyalog applications. Using the File/Export menu item on the Session window, you can create a standard Windows executable program file (EXE) which contains your workspace bound to the Run-Time DLL. To distribute your application, you need to supply and install:</p><ol><li value="1">your bound executable (EXE)</li><li value="2">The Run-Time DLL</li></ol><p>whatever additional files that may be required by your application</p><p>The command-line for your application should simply invoke your EXE, with whatever start-up parameters it may require. Note that your application icon and any start-up parameters for the Run-Time DLL are specified and bound with the EXE when you make it.</p><p>If your application uses any component of the Microsoft .Net Framework, you must distribute the Bridge DLL and DyalogNet DLLs. These DLLs must either be on the system path or placed in the same directory as your EXE. If you are going to use your application with ASP.NET, the DLLs must also be installed in the global assembly cache (GAC) using the <span class="Code">gacutil.exe</span> utility program.</p><h4><a name="Workspace_RunTime"></a>Workspace based run-time</h4><p>A workspace based run-time application consists of the Dyalog APL Run-Time Program (Run-Time EXE) and a separate workspace. To distribute your application, you need to supply and install:</p><ol><li value="1">your workspace</li><li value="2">the Run-Time EXE</li><li value="3">whatever additional files that may be required by your application</li></ol><p>The command-line for your application invokes the Run-Time EXE, passing it start-up parameters required for the Run-Time EXE itself (such as MAXWS) and any start-up parameters that may be required by your application. You will need to associate your own icon with your application during its installation.</p><p>If your application uses any component of the Microsoft .Net Framework, you must distribute the Bridge DLL and DyalogNet DLLs. These DLLs must either be on the system path or placed in the same directory as your EXE. If you are going to use your application with ASP.NET, the DLLs must also be installed in the global assembly cache (GAC) using the <span class="Code">gacutil.exe</span> utility program.</p><h4><a name="Out_Of_Process_COM"></a>Out-of-process COM Server</h4><p>To make an out-of-process COM Server, you must:</p><ol><li value="1">establish one or more OLEServer namespaces in your workspace, populated with functions and variables that you wish to export as methods, properties and events.</li><li value="2">use the <span class="Name">File/Export …</span> menu item on the Session window to register the COM Server on your computer so that it is ready for use.</li></ol><p>The command-line for your COM Server invokes the Run-Time EXE, passing it the start-up parameters required for the Run-Time EXE itself (such as MAXWS) and any start-up parameters that may be required by your application.</p><p>To distribute an out-of-process COM Server, you need to supply and install the following files:</p><ol><li value="1">your workspace</li><li value="2">the associated Type Library (.tlb) file (created by <span class="Name">File/Export</span>)</li><li value="3">the Run-Time EXE</li><li value="4">whatever additional files that may be required by your application</li></ol><p>To install an out-of-process COM Server you must set up the appropriate Windows registry entries. See Interface Guide for details.</p><h4><a name="In_Process_COM"></a>In-process COM Server</h4><p>To make an in-process COM Server, you must:</p><ol><li value="1">establish one or more OLEServer namespaces in your workspace, populated with functions and variables that you wish to export as methods, properties and events.</li><li value="2">use the <span class="Name">File/Export …</span> menu item on the Session window to create an in-process COM Server (DLL) which contains your workspace bound to the Run-Time DLL. This operation also registers the COM Server on your computer so that it is ready for use.</li></ol><p>To distribute your component, you need to supply and install</p><p>Your COM Server file (DLL)</p><ol><li value="1">the Run-Time DLL</li><li value="2">whatever additional files that may be required by your COM Server.</li></ol><p>Note that you must register your COM Server on the target computer using the <span class="Code">regsvr32.exe</span> utility.</p><h4><a name="ActiveXControl"></a>ActiveX Control</h4><p>To make an ActiveX Control, you must:</p><ol><li value="1">establish an ActiveXControl namespace in your workspace, populated with functions and variables that you wish to export as methods, properties and events.</li><li value="2">use the <span class="Name">File/Export …</span> menu item on the Session window to create an ActiveX Control file (OCX) which contains your workspace bound to the Run-Time DLL. This operation also registers the ActiveX Control on your computer so that it is ready for use.</li></ol><p>To distribute your component, you need to supply and install</p><p>Your ActiveX Control file (OCX)</p><ol><li value="1">the Run-Time DLL</li><li value="2">whatever additional files that may be required by your ActiveX Control.</li></ol><p>Note that you must register your ActiveX Control on the target computer using the <span class="Code">regsvr32.exe</span> utility.</p><h4><a name="Net_Assembly"></a>Microsoft .Net Assembly</h4><p>A Microsoft .Net Assembly contains one or more .Net Classes. To make a Microsoft .Net Assembly, you must:</p><ol><li value="1">establish one or more NetType namespaces in your workspace, populated with functions and variables that you wish to export as methods, properties and events.</li><li value="2">use the <span class="Name">File/Export …</span> menu item on the Session window to create a Microsoft .Net Assembly (DLL) which contains your workspace bound to the Run-Time DLL.</li></ol><p>To distribute your .Net Classes, you need to supply and install</p><ol><li value="1">your Assembly file (DLL)</li><li value="2">the Run-Time DLL</li><li value="3">the Bridge DLL</li><li value="4">the DyalogNet DLL</li><li value="5">whatever additional files that may be required by your .Net Assembly.</li><li value="6">the Bridge DLL and DyalogNet DLLs must either be on the system path or placed in the same directory as your EXE. If you are going to use your Assembly with ASP.NET, the DLLs must also be installed in the global assembly cache (GAC) using the <span class="Code">gacutil.exe</span> utility program.</li></ol><h4><a name="Data_Binding"></a>Data Binding</h4><p>If  your runtime application makes use of Data Binding, you will also need to include <span class="Code">dyalogdata4.5.dl</span>. </p><p>The <span class="Code">dyalogdata4.5.dll</span> provides advanced support for Data Binding and Syncfusion. In particular it provides the <span class="NetType">INotifyCollectionChanged</span>
interface which is required to support data binding of collections and lists. This DLL requires .Net Version 4.5 and is not used unless .Net 4.5 is enabled.</p><h4><a name="Syncfusion"></a>Additional Files for Syncfusion</h4><p>Under a licensing agreement with Syncfusion, Dyalog includes the Syncfusion library of WPF controls. These may be used by Dyalog APL users to develop applications, and may be distributed with Dyalog APL run-time applications.</p><p>The Syncfusion libraries comprise a set of .NET assemblies which are supplied in the <span class="Name">Syncfusion/4.5</span> sub-directory of the main Dyalog APL installation directory (for example: <span class="Name">c:\Program Files\Dyalog\Dyalog APL-64 14.0 Unicode\Syncfusion\4.5</span>.</p><p>If you use any of the Syncfusion controls in your runtime application, you must include the SyncFusion library. </p><h4><a name="SQAPL"></a>Additional Files for SQAPL</h4><p>If your application uses the <span class="Name">SQAPL/EL ODBC</span> interface, you must distribute and install four additional files, according to the Edition you are using, as shown in the tables below. </p><table><tr><th class="Left">Name</th><th class="Left">File</th></tr><tr><td class="SubHeading">32-bit Unicode</td><td class="SubHeading">Dyalog APL 14.0 Unicode\</td></tr><tr><td>SQAPL INI</td><td class="Code">sqapl.ini</td></tr><tr><td>SQAPL ERR</td><td class="Code">sqapl.err</td></tr><tr><td>SQAPL DLL</td><td class="Code">cwdya62u32w.dll</td></tr><tr><td>APLUNICD INI</td><td class="Code">aplunicd.ini</td></tr><tr><td class="SubHeading">32-bit Classic</td><td class="SubHeading">Dyalog APL 14.0 Classic\</td></tr><tr><td>SQAPL INI</td><td class="Code">sqapl.ini</td></tr><tr><td>SQAPL ERR</td><td class="Code">sqapl.err</td></tr><tr><td>SQAPL DLL</td><td class="Code">cwdya62c32w.dll</td></tr><tr><td>APLUNICD INI</td><td class="Code">aplunicd.ini</td></tr><tr><th class="Left">Name</th><th class="Left">File</th></tr><tr><td class="SubHeading">64-bit Unicode</td><td class="SubHeading">Dyalog APL-64 14.0 Unicode\</td></tr><tr><td>SQAPL INI</td><td class="Code">sqapl.ini</td></tr><tr><td>SQAPL ERR</td><td class="Code">sqapl.err</td></tr><tr><td>SQAPL DLL</td><td class="Code">cwdya62u64w.dll</td></tr><tr><td>APLUNICD INI</td><td class="Code">aplunicd.ini</td></tr><tr><td class="SubHeading">64-bit Classic</td><td class="SubHeading">Dyalog APL-64 14.0 Classic\</td></tr><tr><td>SQAPL INI</td><td class="Code">sqapl.ini</td></tr><tr><td>SQAPL ERR</td><td class="Code">sqapl.err</td></tr><tr><td>SQAPL DLL</td><td class="Code">cwdya62c64w.dll</td></tr><tr><td>APLUNICD INI</td><td class="Code">aplunicd.ini</td></tr></table><p>The SQAPL DLL must be installed in the user’s Windows directory or be on the user’s path.</p><h4><a name="Miscellaneous"></a>Miscellaneous Other Files</h4><h4>AUXILIARY PROCESSORS</h4><p>If you use any of the Auxiliary Processors (APs) included in the sub-directory <span class="Code">xutils</span>, you must include these with your application. Note that, like workspaces, Dyalog APL searches for APs using the <span class="Parameter">wspath</span> parameter. If your application uses APs, you must ensure that you specify <span class="Parameter">wspath</span> or that the default <span class="Parameter">wspath</span> is adequate for your application..</p><h4>DYALOG32 and/or DYALOG64</h4><p>This DLL is used by some of the functions provided in the <span class="Code">QUADNA.DWS</span> workspace. If you include any of these in your application this DLL must be installed in the user’s Windows directory or be on the user’s path.</p><h4><a name="RunTime_Registry"></a>Registry Entries for Run-Time Applications</h4><p>The Run-Time DLL does not obtain any parameter values from the Windows registry. If you need to specify any Dyalog APL parameter values, they must be defined in the command line when you create an EXE.</p><p>The Run-Time EXE <span class="Italic">does</span> obtain parameter values for the Windows registry, but does not require them to be present. If the default values of certain parameters are inappropriate, you may specify their values on the command line. There is normally no requirement to install registry entries for a run-time application that uses the Run-Time EXE.</p><p>For example, your application may require a greater or lesser <span class="Parameter">maxws</span> parameter (workspace size) than the default value. This may be done by adding the phrase <span class="Code">MAXWS=nnnn</span> (where <span class="Code">nnnn</span> is the required workspace size) after the name of your application workspace on the command line, for example:</p><pre class="Code">      dyalogrt.exe MYAPP.DWS MAXWS=200M</pre><p>Note that the default value of the <span class="Parameter">DYALOG</span> parameter (which specifies where it looks for various other files and sub-directories) is the directory from which the application (<span class="Code">dyalogrt.exe</span>) is loaded.</p><p>Nevertheless, registry entries will be required in the following circumstances.</p><ol><li value="1">If your Classic Edition run-time application requires that the user inputs APL characters, you will need to specify input/output tables (parameters <span class="Parameter">APLK</span>, <span class="Parameter">APLT</span>, <span class="Parameter">APLKEYS</span> and <span class="Parameter">APLTRANS</span>).</li></ol><h4><a name="Registry_Installation"></a>Installing Registry Entries</h4><p>To specify parameters using the Registry, you must install a suitable registry folder for each user of your application. By default, Version <span class="TitlePageVersion">14.0</span> will use registry folders simlar to:</p><pre class="Code">HKEY_CURRENT_USER\Software\Dyalog\Dyalog APL/W <span class="TitlePageVersion">14.0</span> Unicode</pre><p>or</p><pre class="Code">HKEY_LOCAL_MACHINE\SOFTWARE\Dyalog\Dyalog APL/W-64 <span class="TitlePageVersion">14.0</span></pre><p>You may choose a different name for your registry folder if you wish. If so, you must tell Dyalog APL the name of this folder by specifying the <span class="Parameter">INIFILE</span> parameter on the command line. For example:</p><pre class="Code">dyalogrt.exe myapp.dws INIFILE=Software\MyCo\MyApplication</pre><p>You may install entries into the registry folder in one of two ways:</p><ol><li value="1">Using a proprietary installation program such as <span class="Name">InstallShield</span></li><li value="2">Using the <span class="Code">REGEDIT</span> utility. This utility program installs registry entries defined in a text file that is specified as the argument to the program. For example, if your file is called <span class="Code">APLAPP.REG</span>, you would install it on your user’s system by executing the command:</li></ol><blockquote><pre class="Code">REGEDIT APLAPP.REG</pre><p>An example 5-line file that specifies the <span class="Parameter">APLNID</span> and <span class="Parameter">MAXWS</span> parameters might be as follows:</p><pre class="Code">Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Dyalog\Dyalog APL/W <span class="TitlePageVersion">14.0</span>]
"aplnid"="42"
"maxws"="8096"</pre></blockquote></body>
</html>