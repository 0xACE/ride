<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../help.css"></head>
<body><h2><a name="Session_Configuration"></a>Configuring the Session</h2><p>As supplied, your default session will have a menu bar, a tool bar and a status bar. There are many ways in which you may configure this set-up, including the following:</p><p class="p_1">You may select a different APL font or character size.</p><p class="p_1">You may alter the appearance of the menus by changing the Caption properties of the various Menu and MenuItem objects. For example, you may prefer the menus to appear in your own language.</p><p class="p_1">You may alter the structure of the menus. For example, you may wish to create a <span class="Name">Search</span> menu directly on the menu bar rather than having <span class="Name">Find and Replace</span> as part of the <span class="Name">Edit</span> menu.</p><p class="p_1">You may add new Menu and MenuItem objects to the menu bar, or new Button objects to the tool bar, that execute APL functions or expressions for you. You can store the code inside the <tt>⎕SE</tt> namespace so that it is remains available when you switch from one workspace to another.</p><p class="p_1">You may add other objects to the tool bar to allow you to provide input for your functions or to display output. For example, you may display a Combo object that offers you a selection of names applicable to a particular task.</p><p class="p_1">You may add additional toolbars.</p><p class="p_1">You may remove objects too; for example, you can remove fields from the StatusBar or even delete it entirely. Indeed, you may dispense with the menu bar and/or tool bar as well.</p><p>This section illustrates how you can configure your session using worked examples. The examples are by no means exhaustive, but are designed to demonstrate the principles. Please note that the structure and names of the objects used in these examples may not be identical to your default session as supplied. Before you attempt to change your session, please check the structure and the object names using <tt>⎕WN</tt> and <tt>⎕WG</tt>. The supplied session was created using the function BUILD_SESSION in the workspace BUILDSE. If you wish to make substantial changes to your session, you may find it most convenient to edit the functions in this workspace, re-run BUILD_SESSION, and then save it.</p><p>Please note that these examples assume that <span class="Name">Expose Session Properties</span> is enabled.</p><h4><a name="Changing_Font"></a>Changing the Font</h4><p>The APL session font is defined by the Font property of <tt>⎕SE</tt>. To change the font <b>permanently</b>, you should select a different Font and/or size of Font using the combo and spinner boxes on the Session toolbar, and <b>save your Session</b>.</p><p>Classic Edition is distributed with bitmap fonts suitable for use on your screen, and TrueType fonts for your printer. You <span class="Italic">can</span> use the TrueType font on the screen, but it is less attractive than the bitmap fonts at low resolutions. The bitmap fonts come in two sizes (16 x 8 and 22 x 11) and two weights (normal and bold). You may select other sizes, so long as the height is a multiple of 16 or 22. The scaling is performed automatically by Windows.</p><h4><a name="Changing_Menu"></a>Changing Menu Appearance</h4><p>The name of the Session MenuBar is '<tt>⎕SE.mb</tt>'. To simplify the specification of object names, we will first change space to the MenuBar itself:</p><pre>      )CS ⎕SE.mb
⎕SE.mb</pre><p>The names of the Menu objects owned by the MenuBar are given by the expression:</p><pre>      'Menu' ⎕WN ''
file  edit  view  windows  session  log  action  options  tools  help</pre><p>The current caption on the file menu is:</p><pre>    file.Caption
&amp;File</pre><p>To change the Caption to Workspace:</p><pre>    file.Caption←'Workspace'</pre><p>To change the colour of the <span class="Name">New</span> option in the <span class="Name">File</span> menu to red:</p><pre>    file.clear.FCol←255 0 0</pre><h4><a name="Reorganising_Menu"></a>Reorganising the Menu Structure</h4><p>This example shows how you may alter the structure of the session menus by adding a <span class="Name">Search</span> menu to the menu bar to provide access to the <span class="Name">Find</span> and <span class="Name">Find/Replace</span> dialog boxes and removing these options from the <span class="Name">Edit</span> menu.</p><p>To simplify the process, we will first change space into the MenuBar object itself:</p><pre>      )CS ⎕SE.mb
⎕SE.mb</pre><p>Then we can begin by adding the <span class="Name">Search</span> menu. You can specify where the new menu is to be added using its Posn property. In this case, <span class="Name">Search</span> will be added at position 3 (after <span class="Name">Edit</span>).</p><pre>      'search'⎕WC 'Menu' '&amp;Search' 3</pre><p>Next we will remove the Find and Replace MenuItem objects from the <span class="Name">Edit</span> menu. Their names can be obtained from <tt>⎕WN</tt>:</p><pre>      'MenuItem'⎕WN'edit'
edit.prev  edit.next  edit.clear  edit.copy  edit.paste  
edit.find  edit.replace</pre><p>It is worth noting that these MenuItems perform their actions because their Event property is set to execute the system operations <tt>[Find]</tt> and <tt>[Replace]</tt> respectively when they are selected.</p><pre>      edit.find.Event
  Select  [Find]  
      edit.replace.Event
  Select  [Replace]</pre><p>The following statement removes them from the <span class="Name">Edit</span> menu:</p><pre>      ⎕EX¨'edit.find' 'edit.replace'</pre><p>and the following statements add them to the Search menu:</p><pre>      'search.find' ⎕WC 'MenuItem' '&amp;Find'
                        ('Event' 'Select' '[Find]')
      'search.replace' ⎕WC 'MenuItem' '&amp;Replace'
                        ('Event' 'Select' '[Replace]')</pre><h4><a name="Adding_MenuItem"></a>Adding your own MenuItem</h4><p>This example shows how you can add a menu item that executes an APL expression. In this case we will do something very simple; namely add a <span class="Name">Time</span> option to the Tools menu which will execute <tt>⎕TS</tt>. Notice that the statement also defines a Hint. This will be displayed when you select the option, prior to releasing the mouse button to action it.</p><p>Once again, we will start by changing space into the <span class="Name">Tools</span> menu itself</p><pre>      )CS ⎕SE.mb.tools
⎕SE.mb.tools</pre><p>Then we will define a new MenuItem to perform the action we require:</p><pre>      'ts'⎕WC'MenuItem' '&amp;Time'
             ('Event' 'Select' '⍎⎕TS')
             ('Hint' 'Display Timestamp')</pre><p>The <tt>⍎</tt> symbol is very important and distinguishes an expression to be executed immediately, as in this case, from a callback function. The resulting <span class="Name">Tools</span> menu now appears as follows:</p><p><img src="../images/customised-session-tools-menu.png" /></p><p class="ImageCaption">A customised Tools menu</p><p>Selecting <span class="Name">Time</span> produces the following output in the session:</p><pre>      2007 12 10 17 10 2 0</pre><h4><a name="Adding_ToolButton"></a>Adding your own Tool Button</h4><p>This example shows how you can add a button to the session tool bar that executes an APL function.</p><p>The example function we will use is called <tt>XREF</tt>. This function analyses another function, listing the sub-functions that it calls. Instead of returning a result, this example displays the sub-functions in a Form.</p><pre>     ∇ XREF FN;REFS
[1]    :If 0&lt;⍴FN
[2]    :AndIf 3=⎕NC FN
[3]        REFS←⎕REFS FN
[4]        REFS←(3=⎕NC REFS)⌿REFS
[5]        REFS←(↓REFS)~¨' '
[6]        REFS←REFS~⊂FN
[7]        :If 0&lt;⍴REFS
[8]            'F'⎕WC'Form'('Functions called by ',FN)
[9]            F.FontObj←⎕SE.FontObj
[10]           'F.L'⎕WC'List'REFS(0 0)(100 100)
[11]       :EndIf
[12]   :EndIf
     ∇</pre><p>To make this function available from a Session tool button, we need to do a number of things.</p><p>Firstly, we must install the function in <tt>⎕SE</tt> so that it is always there, regardless of the current active workspace. This is easily achieved using the Explorer or <tt>⎕NS</tt>.</p><pre>      '⎕SE' ⎕NS 'XREF'</pre><p>Secondly, we need to find another way to specify its argument <tt>FN</tt>. One possibility would be to display a dialog box, asking the user to specify the name of the function to be analysed. A neater solution is to use the CurObj property of <tt>⎕SE</tt> which reports the name under the cursor. Using CurObj, the user can simply place the cursor over the name of the function to be analysed, and then click the <tt>XREF</tt> tool button.</p><p>To get <tt>FN</tt> from CurObj, all we need to do is to change the header and lines 1-2 to:</p><pre>[0]   XREF;FN;REFS
[1]   :If 0&lt;⍴FN←⎕SE.CurObj
[2]   :AndIf 3=⎕NC FN←⎕SE.CurSpace,'.',FN </pre><p>Notice that the function name reported by CurObj is prefixed by its pathname which comes from the CurSpace property. This reports the user’s current namespace.</p><p>Next we will add a new button to the tool bar in the <span class="Name">Tools</span> CoolBand. Ideally we would use a suitable bitmap, but to simplify the example, we will use a standard text button:</p><pre>      )CS ⎕SE.cbtop.bandtb3.tb
⎕SE.cbtop.bandtb3.tb
 
      'xref' ⎕WC 'Button' 'XREF'
      'xref' ⎕WS 'Event' 'Select' '⍎⎕SE.XREF'</pre><p><img src="../images/customised-session-toolbar.png" /></p><p class="ImageCaption">Adding a tool button</p><script src="../../../help.js"></script></body>
</html>