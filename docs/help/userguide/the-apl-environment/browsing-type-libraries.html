<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../help.css"></head>
<body><h2><a name="Browsing_Type_Libraries"></a>Browsing Type Libraries</h2><p>When the <span class="Name">View/Type Libraries</span> option is enabled, the <span class="Name">Workspace Explorer</span> allows you to:</p><ul><li value="1">Browse the Type Libraries for all the COM server objects that are installed on your computer, whether or not they are loaded in your workspace.</li><li value="2">Load Type Libraries for COM objects</li><li value="3">Browse the Type Library associated with an OLEClient object that is already instantiated in the workspace.</li></ul><p>If the Microsoft .Net Framework is installed, you may in addition:</p><ul><li value="1">Load Metadata for specific .Net classes</li><li value="2">Browse the loaded Metadata, viewing information about classes, methods, properties and so forth.</li></ul><p>If the <span class="Name">Type Libraries</span> option is enabled, the <span class="Italic">Workspace Explorer</span> displays a folder labelled <span class="Name">TypeLibs</span> which, when opened, displays two others labelled <span class="Name">Loaded Libraries</span> and <span class="Name">Registered Libraries </span>as shown below.</p><p><img src="../images/browsing-type-libraries.png" /></p><h4><a name="Registered_Libraries"></a>Browsing Registered Libraries</h4><p>If you open the Registered Libraries folder, the <span class="Name">Workspace Explorer</span> will display in the tree view pane the names of all the Type Libraries associated with the COM Server objects that are installed on your computer.</p><p>If you select one of these Library names, some summary information is displayed in the list view pane.</p><p>For example, the result of selecting the Microsoft Excel 9.0 Object Library is illustrated below.</p><p><img src="../images/browsing-registered-libraries-1.png" /></p><p>If instead, you select the Registered Libraries folder itself, the list of Registered Type Libraries is displayed in the list view pane</p><p><img src="../images/browsing-registered-libraries-2.png" /></p><h4><a name="Loading_Type_Library"></a>Loading a Type Library</h4><p>You can load a library shown in the list view pane by double-clicking its name.</p><p>Alternatively, you can load a library shown in the tree view pane by selecting <span class="Name">Load</span> from its context menu.</p><p>In either case, a message box will appear asking you to confirm. The operation to load a Type Library may take a few moments to complete.</p><p>Notice that if the selected Library references any other libraries, they too will be loaded. For example, loading the <span class="Name">Microsoft Excel 9.0 Object Library</span> brings in the <span class="Name">Microsoft Office 9.0 Object Library</span> and the <span class="Name">Microsoft Visual Basic for Applications Extensibility 5.3 Library</span> too. It also contains references to a general library called the <span class="Name">OLE Automation Type Library</span>, so this is also loaded.</p><p>When you <tt>)SAVE</tt> your workspace, all of the Type Libraries that you have loaded will be saved with it. Note that type library information can take up a considerable amount of workspace.</p><h4><a name="Browsing_Loaded_Libraries"></a>Browsing Loaded Libraries</h4><p>If you have already loaded any Type Libraries into the workspace, using the Workspace Explorer or as a result of creating one or more OLEClient objects, you can select and open the Loaded Libraries folder.</p><p>The picture below illustrates the effect of having loaded the Microsoft Excel 9.0 Object Library.</p><p><img src="../images/browsing-loaded-libraries-1.png" /></p><p>Notice that any external references to other libraries causes these to be brought in too.</p><p>If you select a loaded Type Library, summary information is displayed in the list view pane.</p><p>If you open a loaded Type Library, four sub-folders appear named <span class="Name">Object CoClasses</span>, <span class="Name">Objects</span>, <span class="Name">Enums</span> and <span class="Name">Event Sets</span> respectively.</p><h4><a name="Object_CoClasses"></a>Object CoClasses</h4><p>A Type Library describes a number of <span class="Italic">objects</span>. Typically, all of the objects have properties and methods, but only some of them, perhaps just a few, generate events. Objects which generate events are represented by <span class="Italic">CoClasses</span>, each of which has a pointer to the object itself and a pointer to an event set.</p><p>For example, the Microsoft Excel 9.0 Object Library contains seven CoClasses named <span class="Name">Application</span>, <span class="Name">Chart</span>, <span class="Name">Global</span> etc as shown below.</p><p><img src="../images/browsing-loaded-libraries-2.png" /></p><p>Opening the Application folder you can see that the <span class="Name">Application</span> CoClass comprises the <span class="Name">_Application</span> object coupled with the <span class="Name">AppEvents</span> event set as shown below.</p><p><img src="../images/browsing-loaded-libraries-3.png" /></p><p>The specific methods, properties and events supported by the CoClass object can be examined by opening the appropriate sub-folder. The same information for these and other objects is also accessible from the <span class="Name">Objects</span> and <span class="Name">Event Sets</span> folders as discussed below.</p><h4><a name="Objects"></a>Objects</h4><p>The <span class="Name">Objects</span> folder contains several sub-folders each of which represents a named object defined in the library.</p><p>Each object folder contains two sub-folders named Methods and Properties. Selecting one of these causes the list of Methods or Properties to be displayed in the list view pane. The picture below shows the Methods exposed by the Microsoft Excel 9.0 Range object.</p><p><img src="../images/browsing-loaded-libraries-4.png" /></p><p>If you open the <span class="Name">Methods</span> or <span class="Name">Properties</span> subfolder, you can display more detailed information about individual Methods and Properties. For example, the following picture shows information about the <span class="Name">SaveAs</span> method exposed by the Microsoft Excel 9.0 Worksheet object.</p><p><img src="../images/browsing-loaded-libraries-5.png" /></p><p>This tells you that the <span class="Name">SaveAs</span> method takes up to 9 parameters of which the first, Filename, is mandatory and is of data type VT_BSTR (a character string). Note that [in] indicates that the parameter is an <span class="Italic">input</span> parameter.</p><p>Incidentally, the optional Fileformat parameter is an example of a parameter whose value must be one of a list of Enumerated Constants. Even without looking at the documentation, the possible values can be deduced by browsing the <span class="Name">Enums</span> folder, with the results shown below.</p><p><img src="../images/browsing-loaded-libraries-6.png" /></p><p>You can therefore deduce that the following expression, executed in the namespace associated with the currently active worksheet, will save the sheet in comma-separated format (CSV) in a file called mysheet.csv:</p><pre>     SaveAs 'MYSHEET.CSV' xlCSV</pre><p>or</p><pre>     SaveAs 'MYSHEET.CSV' 6</pre><h4><a name="Event_Sets"></a>Event Sets</h4><p>The <span class="Name">Event Sets</span> folder contains several sub-folders each of which represents a named set of events generated by the objects defined in the library.</p><p>If you open one of these event sets, the names of the events it contains are displayed in the tree view pane. If you then select one of the events, its details are displayed in the list view pane as shown below.</p><p><img src="../images/browsing-loaded-libraries-7.png" /></p><p>This example shows that when it fires, the SheetActivate event invokes your callback function with a single argument named <span class="Name">Sh</span> whose datatype is VT_DISPATCH (in practice, a Worksheet object).</p><h4><a name="Enums"></a>Enums</h4><p>The <span class="Name">Enums</span> folder will typically contain several sub-folders each of which represents a named set of enumerated constants.</p><p>If you select one of these sets, the names and values of the constants it contains are displayed in the list view pane as shown below.</p><p><img src="../images/browsing-loaded-libraries-8.png" /></p></body>
</html>