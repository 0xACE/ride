<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../../help.css"></head>
<body><h4>Example 6</h4><p>This example illustrates data binding using a vector of .Net objects, in this case <span class="NetType">DateTime</span> objects.</p><h4>The XAML</h4><p> The XAML shown below,  describes a Window containing a <span class="NetType">StackPanel</span>, inside which is a <span class="NetType">ListBox</span>.</p><pre class="Code">&lt;Window 

    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="NetObjects (DateTime) Example"
    SizeToContent="WidthAndHeight" &gt;
    &lt;StackPanel&gt;
         &lt;TextBlock Text="Dates of forthcoming Orthodox Easters"
          FontSize="18" Margin="5"/&gt;
         &lt;ListBox Name="EasterDates" Height="100"
          Margin="5" /&gt;
    &lt;/StackPanel&gt;
&lt;/Window&gt;</pre><h4>The APL Code</h4><p>The function <tt>NetObjects</tt> is shown below.</p><pre>     ∇ NetObjects;⎕USING;win;dt
[1]    ⎕USING←'System'
[2]    win←LoadXAML XAML
[3]    win.dates←win.FindName⊂'EasterDates'
[4]    dt←{⎕NEW DateTime ⍵}¨Easter
[5]    win.dates.ItemsSource←2015⌶'dt'
[6]    sink←win.ShowDialog
     ∇
</pre><p><tt>NetObjects[3]</tt> uses <span class="Member">FindName</span> to obtain a ref to the <span class="NetType">ListBox</span> (defined in the XAML) named <span class="Name">EasterDates:</span></p><pre>
[3]    win.dates←win.FindName⊂'EasterDates'</pre><p>The global variable <tt>Easter</tt> contains a vector of 3-element numeric vectors representing the dates of forthcoming Orthodox Easter Sundays. </p><pre>      ↑Easter
2015 4 12
2016 5  1
2017 4 16
2018 4  8
2019 4 28
2020 4 19
2021 5  2
2022 4 24
2023 4 16
2024 5  5
</pre><p><tt>NetObjects[4]</tt> creates a vector of <span class="NetType">DateTime</span> objects from the global variable <tt>Easter</tt>.</p><pre>
[4]    dt←{⎕NEW DateTime ⍵}¨Easter</pre><p>Then, NetObjects[5] creates a binding source object from this array and assigns it to the ItemsSource property of the ListBox.</p><pre>
[5]    win.dates.ItemsSource←2015⌶'dt'</pre><h4>Testing the Data Binding</h4><pre>      )LOAD WPFIntro
      DataBinding.NetObjects.NetObjects
</pre><p><img src="../../images/data-binding-netobjects1.png" /></p><script src="../../../../help.js"></script></body>
</html>