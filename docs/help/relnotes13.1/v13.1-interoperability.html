<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../help.css"></head>
<body><h2><a name="Interoperability"></a>Interoperability
        </h2><h4>Introduction</h4><p>Workspaces and component files are stored on disk in a binary format (illegible to text editors). This format differs between machine architectures and among versions of Dyalog. For example a file component written by a PC may well have an internal format that is different from one written by a UNIX machine. Similarly, a workspace saved from Dyalog Version 13.1 will differ internally from one saved by a previous version of Dyalog APL.</p><p>It is convenient for versions of Dyalog APL running on different platforms to be able to
<span class="Italic">interoperate</span> by sharing workspaces and component files. From Version 11.0, component files and workspaces can generally be shared between Dyalog interpreters running on different platforms. However, this is not always possible, for example:</p><ul><li value="1">Component files created by Version 10.1 can often not be shared across platforms, even when used by later versions.</li><li value="2"><span class="Italic">Small-span</span> (32-bit) component files become read-only when opened on a different architecture from that on which they were created.</li></ul><p>Note however that the system function <tt>⎕FCOPY</tt> can be used to make a logically identical copy of an old file, which is fully inter-operable. </p><p>The following sections describe other limitations in inter-operability:</p><h4>Code</h4><p>Code which is saved in workspaces, or embedded within <tt>⎕OR</tt>s stored in component files, can generally only be read by the version which saved them and later versions of the interpreter. In the case of workspaces, a load (or copy) into an older version would fail with the message:</p><pre>this WS requires a later version of the interpreter.</pre><p>Every time a  <tt>⎕OR</tt> 
object is read by a Version later than that which created it, time may be spent in converting the internal representation into the latest form.  Dyalog recommends that  <tt>⎕OR</tt> should not be used as a mechanism for sharing code or objects between different versions of APL</p><h4>"Ordinary" Arrays</h4><p>With the exception of the Unicode restrictions described in the following paragraphs, Dyalog APL provides inter-operability for arrays which only contain (nested) character and numeric data. Such arrays can be stored in component files - or transmitted using
<tt>TCPSocket</tt> objects and Conga connections, and shared between all versions and across all platforms.</p><p>As mentioned in the introduction, full cross-platform interoperability of component files is only available for large-span component files (see the following section), and for small-span component files created by Version 11.0 or later.</p><h4>32 vs. 64-bit Component Files</h4><p><span class="Italic">Large-span</span> (64-bit-addressing) component files are inaccessible to versions of the interpreter that pre-dated their introduction (versions earlier than 10.1).</p><p>The second item in the right argument of <tt>⎕FCREATE</tt> determines the addressing type of the file.</p><pre>      'small'⎕fcreate 1 32 ⍝ create small-span file.
      'large'⎕fcreate 1 64 ⍝ create large-span file.</pre><p>If the second item is missing, the file type defaults to 64-bit-addressing. In versions prior to 12.0, the default was 32-bit-addressing.  </p><p>Note that <span class="Italic">small-span</span> (32-bit-addressing) component files cannot contain Unicode data. Unicode editions of Dyalog APL can only write character data which would be readable by a Classic
edition (consisting of elements of <tt>⎕AV</tt>).</p><h4>External Variables</h4><p>External variables are implemented as small-span (32-bit-addressing) component files, and subject to the same restrictions as these files. External variables are unlikely to be developed further; Dyalog recommends that applications which use them should switch to using mapped files or traditional component files. Please contact Dyalog if you need further advice on this topic.</p><h4>32 vs. 64-bit Interpreters</h4><p>From Dyalog APL Version 11.0 onwards, there are two separate versions of programs for 32-bit and 64-bit machine architectures (the 32-bit versions will also run on 64-bit machines running 64-bit operating systems). There is complete inter-operability between 32- and 64-bit interpreters, except that 32-bit interpreters are unable to work with arrays or workspaces greater than 2GB in size.</p><h4>Unicode vs. Classic Editions</h4><p>From Version 12.0 onwards, a Unicode edition is available, which is able to work with the entire Unicode character set. Classic editions (a term which includes versions prior to 12.0) are limited to the 256 characters defined in the atomic vector, <tt>⎕AV</tt>). </p><p>Component files have a Unicode property. When this is enabled, all characters will be written as Unicode data to the file. The Unicode property is always off for small-span (32-bit addressing) files, which may not contain Unicode data. For large-span (64-bit addressing) component files, the Unicode property is on by default but can be toggled on and off using
<tt>⎕FPROPS</tt>.</p><p>When a Unicode edition writes to a component file which may not contain Unicode data, character data is mapped using      <tt>⎕AVU</tt>, and can therefore be read without problems by Classic editions.</p><p>A <tt>TRANSLATION ERROR</tt> will occur if a Unicode edition writes to a non-Unicode component  (that is either a 32-bit file, or a 64-bit file when the Unicode property is currently off) if the data being written contains characters which are not in <tt>⎕AVU</tt>. </p><p>Likewise, a Classic edition (Version 12.0 or later) will issue a <tt>TRANSLATION ERROR</tt> if it attempts to read a component containing Unicode data not in <tt>⎕AVU</tt> from a component file.  Version 11.0 cannot read components containing Unicode data and issues a <tt>NONCE ERROR</tt>.</p><p>A <tt>TRANSLATION ERROR</tt> will also be issued when a Classic edition <tt>)LOAD</tt>s or <tt>)COPY</tt>s a workspace containing Unicode data which cannot be mapped to <tt>⎕AV</tt> using the <tt>⎕AVU</tt> in the recipient workspace.</p><p><tt>TCPSocket</tt> objects have an <tt>APL</tt> property which corresponds to the Unicode property of a file, if this is set to <tt>Classic</tt> (the default) the data in the socket will be restricted to <tt>⎕AV</tt>, if Unicode it will contain Unicode character data. As a result, <tt>TRANSLATION ERROR</tt>s can occur on transmission or reception in the same way as when updating or reading a file component.</p><h4>AVU changes</h4><p>The implementation of the function <tt>Right</tt> in Version 13.0 led to the discovery that <tt>⎕AVU</tt> incorrectly defined <tt>⎕AV[59+⎕IO]</tt> as <tt>¤</tt> (<tt>⎕UCS 164</tt>) rather than <tt>⊢</tt> (Right Tack,  <tt>⎕UCS 8866</tt>). This error has been corrected in the default
<tt>⎕AVU</tt> and in workspace <tt>AVU.dws</tt>. If you are operating in a mixed Unicode/Classic environment, this error will have caused earlier Classic editions to map <tt>⎕AV[59+⎕IO]</tt> 
to the wrong Unicode character (<tt>¤</tt>). This may cause <tt>TRANSLATION ERROR</tt>s when a Version 13.0 Classic system attempts to read the data, as it will not be able to represent
<tt>¤</tt>  in the Atomic Vector.</p><h4>DECFs and Complex numbers</h4><p>Version 13.0 introduced two new data types; DECFs and Complex numbers.  Attempts to read components of these types in earlier interpreters will result in a <tt>DOMAIN ERROR</tt>.</p><h4>Very large array components</h4><p>The maximum size (in bytes) of a component written by Version 12.1 and prior is 2GB.  This is the size of the component as held on disk which may be different than the size reported by <tt>⎕SIZE</tt>.  In Version 13.0 the maximum size of a component written by a 64-bit interpreter is 4GB. From Version 13.1 onwards, the limit on the size of arrays or components is so large that for most practical purposes, there is effectively no limit. </p><p>  An attempt to read
a component greater than 2GB in 32-bit interpreters will result in a <tt>WS FULL</tt>. An attempt to read such a component in 64-bit Versions 12.0 and 12.1 patched after 1st April 2011 will result in a  <tt>NONCE ERROR</tt>; earlier patches generate a <tt>FILE COMPONENT DAMAGED</tt> error.</p><h4>File Journaling</h4><p>Version 12.0 introduced File Journaling (level 1), and 12.1 added journaling levels 2 and 3 and checksumming. Versions earlier than 12.0 cannot tie files which have any form of journaling or checksumming enabled. Version 12.0 cannot tie files with journaling levels greater than 1, or checksumming enabled. Attempting to tie such files will result in a <tt>FILE NAME ERROR</tt>. Files can be shared with earlier versions by using <tt>⎕FPROPS</tt> to amend the journaling and checksumming levels.</p><h4>TCPSockets</h4><p>TCPSockets used to communicate between differing versions of Dyalog APL are subject to similar limitations to those described above for component files.  In particular TCPSockets with <tt>'Style' 'APL'</tt> will only be able to pass arrays that are supported by both versions.</p><h4>Auxiliary Processors</h4><p>A Dyalog APL process is restricted to starting an AP of exactly the same architecture. In other words, the AP must share the same word-width and byte-ordering as its interpreter process.</p><h4>Session Files</h4><p>Session (.dse) files may only be used on the platform on which they were created and
saved.</p></body>
</html>