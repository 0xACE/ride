<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../help.css"></head>
<body><h2><tt>{R}←{X} ⎕TGET Y</tt>Get Tokens</h2><p><tt>Y</tt> must be a simple integer scalar or vector that specifies one or more tokens, each with a specific non-zero token type, that are to be retrieved from the pool.</p><p><tt>X</tt> is an optional time-out value in seconds.</p><p>Shy result <tt>R</tt> is a scalar or vector containing the values of the tokens of type <tt>Y</tt> that have been retrieved from the token pool.</p><p>Note that types of the tokens in the pool may be positive or negative, and the elements of <tt>Y</tt> may also be positive or negative.</p><p>A request (<tt>⎕TGET</tt>) for a <span class="Italic">positive</span> token will be satisfied by the presence of a token in the pool with the same positive or negative type. If the pool token has a positive type, it will be removed from the pool. If the pool token has a negative type, it will remain in the pool. N<span class="Italic">egatively </span>typed tokens will therefore satisfy an infinite number of requests for their positive equivalents. Note that a request for a positive token will remove one if it is present, before resorting to its negative equivalent</p><p>A request for a negative token type will only be satisfied by the presence of a negative token type in the pool, and that token will be removed.</p><p>If, when a thread calls <tt>⎕TGET</tt>, the token pool satisfies <b>all</b> of the tokens specified by <tt>Y</tt>, the function returns immediately with a (shy) result that contains the values associated with the pool tokens. Otherwise, the function will block (wait) until <b>all</b> of the requested tokens are present or until a timeout (as specified by <tt>X</tt>) occurs.</p><p>For example, if the pool contains only tokens of type 2:</p><pre>    ⎕TGET 2 4        ⍝ blocks waiting for a 4-token ...</pre><p>The <tt>⎕TGET</tt> operation is atomic in the sense that no tokens are taken from the pool until <b>all</b> of the requested types are present. While this last example is waiting for a 4-token, other threads could take any of the remaining 2-tokens.</p><p>Note also, that repeated items in the right argument are distinct. The following will block until there are at least 3 <tt>×</tt> 2-tokens in the pool:</p><pre>    ⎕TGET 3/2       ⍝ wait for 3 × 2-tokens ...</pre><p>The pool is administered on a first-in-first-out basis. This is significant only if tokens of the same type are given distinct values. For example:</p><pre>    ⎕TGET ⎕TPOOL             ⍝ empty pool.
 
    'ABCDE'⎕TPUT¨2 2 3 2 3  ⍝ pool some tokens.
 
    ⊢⎕TGET 2 3
AC
 
    ⊢⎕TGET 2 3
BE</pre><p>Timeout is signalled by the return of an empty numeric vector <tt>⍬</tt> (zilde). By default, the value of a token is the same as its type. This means that, unless you have explicitly set the value of a token to <tt>⍬</tt>, a <tt>⎕TGET </tt>result of <tt>⍬</tt> unambiguously identifies a timeout.</p><p><b>Beware</b> - the following statement will wait forever and can only be terminated by an interrupt.</p><pre>    ⎕TGET 0       ⍝ wait forever ...</pre><p>Note too that if a thread waiting to <tt>⎕TGET</tt> tokens is <tt>⎕TKILL</tt>ed, the thread disappears without removing any tokens from the pool. Conversely, if a thread that has removed tokens from the pools is <tt>⎕TKILL</tt>ed, the tokens are not returned to the pool.</p></body>
</html>