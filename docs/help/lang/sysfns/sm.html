<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../help.css"></head>
<body><h2><tt>⎕SM</tt>Screen Map </h2><p><tt>⎕SM</tt> is a system variable that defines a character-based user interface (as opposed to a graphical user interface).  In versions of Dyalog APL that support asynchronous terminals, <tt>⎕SM</tt> defines a <b>form</b> that is displayed on the <b>USER SCREEN</b>.  The implementation of <tt>⎕SM</tt> in "window" environments is compatible with these versions.  In Dyalog APL/X, <tt>⎕SM</tt> occupies its own separate window on the display, but is otherwise equivalent.  In versions of Dyalog APL with GUI support, <tt>⎕SM</tt> either occupies its own separate window (as in Dyalog APL/X) or, if it exists, uses the window assigned to the SM object.  This allows <tt>⎕SM</tt> to be used in a GUI application in conjunction with other GUI components.</p><p>In general <tt>⎕SM</tt> is a nested matrix containing between 3 and 13 columns.  Each row of <tt>⎕SM</tt> represents a <b>field</b>; each column a <b>field attribute</b>.</p><p>The columns have the following meanings:</p><table><tr><th class="Left">Column</th><th class="Left">Description</th><th class="Left">Default</th></tr><tr><td>1</td><td>Field Contents</td><td>N/A</td></tr><tr><td>2</td><td>Field Position - Top Row</td><td>N/A</td></tr><tr><td>3</td><td>Field Position - Left Column</td><td>N/A</td></tr><tr><td>4</td><td>Window Size - Rows</td><td> 0</td></tr><tr><td>5</td><td>Window Size - Columns</td><td> 0</td></tr><tr><td>6</td><td>Field Type</td><td> 0</td></tr><tr><td>7</td><td>Behaviour</td><td> 0</td></tr><tr><td>8</td><td>Video Attributes</td><td> 0</td></tr><tr><td>9</td><td>Active Video Attributes</td><td><tt>¯</tt>1</td></tr><tr><td>10</td><td>Home Element - Row</td><td> 1</td></tr><tr><td>11</td><td>Home Element - Column</td><td> 1</td></tr><tr><td>12</td><td>Scrolling Group - Vertical</td><td> 0</td></tr><tr><td>13</td><td>Scrolling Group - Horizontal</td><td> 0</td></tr></table><p>With the exception of columns 1 and 8, all elements in <tt>⎕SM</tt> are integer scalar values.</p><p>Elements in column 1 (Field Contents) may be:</p><ul><li value="1">A numeric scalar</li><li value="2">A numeric vector</li><li value="3">A 1-column numeric matrix</li><li value="4">A character scalar</li><li value="5">A character vector</li><li value="6">A character matrix (rank 2)</li><li value="7">A nested matrix defining a sub-form whose structure and contents must conform to that defined for <tt>⎕SM</tt> as a whole.  This definition is recursive.  Note however that a sub-form must be a matrix - a vector is not allowed.</li></ul><p>Elements in column 8 (Video Attributes) may be:</p><ul><li value="1">An integer scalar that specifies the appearance of the entire field.</li><li value="2">An integer array of the same shape as the field contents.  Each element specifies the appearance of the corresponding element in the field contents.</li></ul><h4>Screen Management (Async Terminals)</h4><p>Dyalog APL for UNIX systems (Async terminals) manages two screens; the SESSION screen and the USER screen.  If the SESSION screen is current, an assignment to <tt>⎕SM</tt> causes the display to switch to the USER screen and show the form defined by <tt>⎕SM</tt>.</p><p>If the USER screen is current, any change in the value of <tt>⎕SM</tt> is immediately reflected by a corresponding change in the appearance of the display.  However, an assignment to <tt>⎕SM</tt> that leaves its value unchanged has no effect.</p><p>Dyalog APL automatically switches to the SESSION screen for default output, if it enters immediate input mode (6-space prompt), or through use of <tt>⎕</tt> or <tt>⍞</tt>.  This means that typing</p><pre>      ⎕SM ← expression</pre><p>in the APL session will cause the screen to switch first to the USER screen, display the form defined by <tt>⎕SM</tt>, and then switch back to the SESSION screen to issue the 6-space prompt.  This normally happens so quickly that all the user sees is a flash on the screen.</p><p>To retain the USER screen in view it is necessary to issue a call to <tt>⎕SR</tt> or for APL to continue processing. e.g.</p><pre>      ⎕SM ← expression  ⋄  ⎕SR 1</pre><p>or</p><pre>      ⎕SM ← expression  ⋄  ⎕DL 5</pre><h4>Screen Management (Window Versions)</h4><p>In Dyalog APL/X, and optionally in Dyalog APL/W, <tt>⎕SM</tt> is displayed in a separate <b>USER WINDOW</b> on the screen.  In an end-user application this may be the only Dyalog APL window.  However, during development, there will be a SESSION window, and perhaps EDIT and TRACE windows too.</p><p>The USER Window will only accept input during execution of <tt>⎕SR</tt>.  It is otherwise "output-only".  Furthermore, during the execution of <tt>⎕SR</tt> it is the only active window, and the SESSION, EDIT and TRACE Windows will not respond to user input.</p><h4>Screen Management (GUI Versions)</h4><p>In versions of Dyalog APL that provide GUI support, there is a special SM object that defines the position and size of the window to be associated with <tt>⎕SM</tt>.  This allows character-mode applications developed for previous versions of Dyalog APL to be migrated to and integrated with GUI environments without the need for a total re-write.</p><h4>Effect of Localisation</h4><p>Like all system variables (with the exception of <tt>⎕TRAP</tt>) <tt>⎕SM</tt> is subject to "pass-through localisation".  This means that a localised <tt>⎕SM</tt> assumes its value from the calling environment.  The localisation of <tt>⎕SM</tt> does not, of itself therefore, affect the appearance of the display.  However, reassignment of a localised <tt>⎕SM</tt> causes the new form to overlay rather than replace whatever forms are defined further down the stack.  The localisation of <tt>⎕SM</tt> thus provides a simple method of defining pop-up forms, help messages, etc.</p><p>The user may edit the form defined by <tt>⎕SM</tt> using the system function <tt>⎕SR</tt>.  Under the control of <tt>⎕SR</tt> the user may change the following elements in <tt>⎕SM</tt> which may afterwards be referenced to obtain the new values.</p><table><tbody><tr><td>Column 1 </td><td>Field Contents</td></tr><tr><td>Column 10 </td><td>Home Element - Row (by scrolling vertically)</td></tr><tr><td>Column 11 </td><td>Home Element - Column (by scrolling horizontally)</td></tr></tbody></table><p> </p><script src="../../../help.js"></script></body>
</html>