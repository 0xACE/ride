<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../help.css"></head>
<body><h2><tt>{R}←⎕CMD Y</tt>Execute Windows Command </h2><p><tt>⎕CMD</tt> executes the Windows Command Processor or UNIX shell or starts another Windows application program.  <tt>⎕CMD</tt> is a synonym of <tt>⎕SH</tt>.  Either system function may be used in either environment (Windows or UNIX) with exactly the same effect.  <tt>⎕CMD</tt> is probably more natural for the Windows user.  This section describes the behaviour of <tt>⎕CMD</tt> and <tt>⎕SH</tt> under Windows. See <a href="execute-unix-command.html#Execute_UNIX_Command" class="MCXref_0">Execute (UNIX) Command </a> for a discussion of the behaviour of these system functions under UNIX.</p><p>The system commands <a href="../syscmds/sh.html#Execute(UNIX)Command"><tt>)SH</tt></a> and <a href="../syscmds/cmd.html#WindowsCommandProcessor"><tt>)CMD</tt></a> provide similar facilities. </p><h4>Executing the Windows Command Processor</h4><p>If <tt>Y</tt> is a simple character vector, <tt>⎕CMD</tt> invokes the Windows Command Processor (normally <tt>cmd.exe</tt>) and passes the command specified by character vector <tt>Y</tt> to it for execution. The term command means here an instruction recognised by the Command Processor, or the pathname of a program (with optional parameters) to be executed by it. In either case, APL waits for the command to finish and then returns the result <tt>R</tt>,  a vector of character vectors containing its result. Each element in <tt>R</tt> corresponds to a line of output produced by the command. </p><h4>Example</h4><pre>      Z←⎕CMD'DIR'
      ⍴Z
8
      ↑Z
 Volume in drive C has no label  
 Directory of C:\DYALOG
 
.            &lt;DIR&gt;     5-07-89  3.02p
..           &lt;DIR&gt;     5-07-89  3.02p
SALES    DWS    110092 5-07-89  3.29p
EXPENSES DWS    154207 5-07-89  3.29p</pre><p>If the command specified in <tt>Y</tt> already contains the redirection symbol (<tt>&gt;</tt>) the capture of output through a pipe is avoided and the result <tt>R</tt> is empty.  If the command specified by <tt>Y</tt> issues prompts and expects user input, it is <b>ESSENTIAL</b> to explicitly redirect input and output to the console.  If this is done, APL detects the presence of a "<tt>&gt;</tt>" in the command line, runs the command processor in a <b>visible</b> window, and does not direct output to the pipe.  If you fail to do this your system will appear to hang because there is no mechanism for you to receive or respond to the prompt.</p><h4>Example</h4><pre>      ⎕CMD 'DATE &lt;CON &gt;CON'</pre><p>(Command Prompt window appears)</p><p><span class="Code">Current date is Wed 19-07-1995</span></p><p><span class="Code">Enter new date (dd-mm-yy): 20-07-95</span></p><p>(COMMAND PROMPT window disappears)</p><h4>Spaces in pathnames</h4><p>If <tt>Y</tt> specifies a program (with or without parameters) and the pathname to the program  contains spaces, you must enclose the string in double-quotes.</p><p>For example, to start a version of Excel to which the pathname is:</p><pre class="Code">   C:\Program Files\Microsoft Office\OFFICE11\excel.exe</pre><p>the argument to <tt>⎕CMD</tt> should be:</p><pre class="APLCodeSmall">⎕CMD '<b>"</b>c:\program files\microsoft office\office11\excel.exe<b>"</b>'
</pre><h4>Double-Quote Restriction</h4><p>The Windows Command Processor does not permit more than one set of double-quotes in a command string. </p><p>The following statements are all valid:</p><pre class="APLCodeSmall">⎕CMD 'c:\windows\system32\notepad.exe c:\myfile.txt'  
⎕CMD 'c:\windows\system32\notepad.exe <b>"</b>c:\myfile.txt<b>"</b>'
⎕CMD '<b>"</b>c:\windows\system32\notepad.exe<b>"</b> c:\myfile.txt'</pre><p>Whereas the next statement, which contains two sets of double-quotes, will fail:</p><pre class="APLCodeSmall">⎕CMD '<b>"</b>c:\windows\system32\notepad.exe<b>"</b><b>"</b>c:\myfile.txt<b>"</b>'</pre><p>Such a statement can however be executed using the second form of <tt>⎕CMD</tt>(where the argument is a 2-element vector of character vectors) which does not use the Windows Command Processor and is not subject to this restriction.Hhowever, the call to <tt>⎕CMD</tt> will return immediately, and no output from the command will be returned. </p><pre class="APLCodeSmall">⎕CMD'<b>"</b>c:\windows\system32\notepad.exe<b>"</b><b>"</b>c:\myfile.txt<b>"</b>' ''</pre><h4 class="ExampleNewPage">Implementation Notes</h4><p>The right argument of <tt>⎕CMD</tt> is simply passed to the appropriate command processor for execution and its output is received using an <span class="Italic">unnamed pipe</span>.  </p><p>By default, <tt>⎕CMD</tt> will execute the string <tt>('cmd.exe /c',Y)</tt>; where <tt>Y</tt> is the argument given to <tt>⎕CMD</tt>.  However, the implementation permits the use of alternative command processors as follows:</p><p>Before execution, the argument is prefixed and postfixed with strings defined by the APL parameters CMD_PREFIX and CMD_POSTFIX.  The former specifies the name of your command processor and any parameters that it requires.  The latter specifies a string which may be required.  If CMD_PREFIX is not defined, it defaults to the name defined by the environment variable COMSPEC followed by  "/c".  If COMSPEC is not defined, it defaults to <span class="Code">cmd.exe</span>.  If CMD_POSTFIX is not defined, it defaults to an empty vector. </p><p><tt>⎕CMD</tt> treats certain characters as having special meaning as follows:</p><table><tbody><tr><td><tt>#</tt></td><td>marks the start of a trailing comment,</td></tr><tr><td><tt>;</tt></td><td>divides the command into sub-commands,</td></tr><tr><td><tt>&gt;</tt></td><td>if found within the last sub-command, causes <tt>⎕CMD</tt> to use a visible window.</td></tr></tbody></table><p>If you simply wish to open a Command Prompt window, you may execute the command as a Windows Program (see below).  For example:</p><pre>      ⎕CMD 'cmd.exe' ''</pre><h4>Starting a Windows Program</h4><p>If <tt>Y</tt> is a 2-element vector of character vectors, <tt>⎕CMD</tt> starts the executable program named by <tt>Y[1]</tt> with the initial window parameter specified by <tt>Y[2]</tt>.  The shy result is an integer scalar containing the window handle allocated by the window manager. Note that in this case APL does not wait for the program specified by <tt>Y</tt> to finish, but returns immediately. The shy result <tt>R</tt> is the process identifier (PID).</p><p><tt>Y[1]</tt> must specify the name or complete pathname of an executable program.  If the name alone is specified, Windows will search the following directories:</p><ol><li value="1">the current directory,</li><li value="2">the Windows directory,</li><li value="3">the Windows system directory,</li><li value="4">the directories specified by the PATH variable,</li><li value="5">the list of directories mapped in a network.</li></ol><p>Note that <tt>Y[1]</tt> may contain the complete command line, including any suitable parameters for starting the program.  If Windows fails to find the executable program, <tt>⎕CMD</tt> will fail and report <tt>FILE ERROR 2</tt>.</p><p><tt>Y[2]</tt> specifies the window parameter and may be one of the following.  If not, a <tt>DOMAIN ERROR</tt> is reported.</p><table><tr><td><tt>'Normal'<br />''</tt></td><td>Application is started in a normal window, which is given the input focus</td></tr><tr><td><tt>'Unfocused'</tt></td><td>Application is started in a normal window, which is NOT given the input focus</td></tr><tr style="height: 15px;"><td><tt>'Hidden'</tt></td><td>Application is run in an invisible window</td></tr><tr><td><tt>'Minimized'<br />'Minimised'</tt></td><td>Application is started as an icon which is NOT given the input focus</td></tr><tr><td><tt>'Maximized'<br />'Maximised'</tt></td><td>Application is started maximized (full screen) and is given the input focus</td></tr></table><p>An application started by <tt>⎕CMD</tt> may ONLY be terminated by itself or by the user.  There is no way to close it from APL.  Furthermore, if the window parameter is HIDDEN, the user is unaware of the application (unless it makes itself visible) and has no means to close it.</p><h4>Examples</h4><pre>      Path←'c:\Program Files\Microsoft Office\Office\'
      ⎕←⎕CMD (Path,'excel.exe') ''
33
      ⎕CMD (Path,'winword /mMyMacro') 'Minimized'</pre><h4>Executing Programs</h4><p>Either form of <tt>⎕CMD</tt> may be used to execute a program. The difference is that when the program is executed via the Command Processor, APL waits for it to complete and returns any result that the program would have displayed in the Command Window had it been executed from a Command Window. In the second case, APL starts the program (in parallel).</p><script src="../../../help.js"></script></body>
</html>