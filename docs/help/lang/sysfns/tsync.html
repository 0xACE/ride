<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../help.css"></head>
<body><h2><tt>R←⎕TSYNC Y</tt>Wait for Threads to Terminate </h2><p><tt>Y</tt> must be a simple array of thread numbers. </p><p>If <tt>Y</tt> is a simple scalar, <tt>R</tt> is an array, the result (if any) of the thread. </p><p>If <tt>Y</tt> is a simple non-scalar, <tt>R</tt> has the same shape as <tt>Y</tt>, and result is an array of enclosed thread results.</p><h4>Examples</h4><pre>      dup←{⍵ ⍵}        ⍝ Duplicate
 
      ⎕←dup&amp;88         ⍝ Show thread number
11
88 88
 
      ⎕TSYNC dup&amp;88    ⍝ Wait for result
88 88
 
      ⎕TSYNC,dup&amp;88
 88 88 
 
      ⎕TSYNC dup&amp;1 2 3
 1 2 3  1 2 3 
 
      ⎕TSYNC dup&amp;¨1 2 3
 1 1  2 2  3 3 </pre><h4>Deadlock</h4><p>The interpreter detects a potential deadlock if a number of threads wait for each other in a cyclic dependency. In this case, the thread that attempts to cause the deadlock issues error number <tt>1008: DEADLOCK</tt>.</p><pre>     ⎕TSYNC ⎕TID      ⍝ Wait for self
DEADLOCK
      ⎕TSYNC ⎕TID
      ^
 
      ⎕EN
1008</pre><h4>Potential Value Error</h4><p>If any item of <tt>Y</tt> does not correspond to the thread number of an active thread, or if any subject thread terminates without returning a result, then <tt>⎕TSYNC</tt> does not return a result. This means that, if the calling context of the <tt>⎕TSYNC</tt> requires a result, for example: <tt>rslt←⎕TSYNC tnums</tt>, a <tt>VALUE ERROR</tt> will be generated. This situation can occur if threads have completed before <tt>⎕TSYNC</tt> is called.</p><pre>      ⎕←÷&amp;4          ⍝ thread (3) runs and terminates.
3
0.25
      ⎕TSYNC 3       ⍝ no result required: no prob
      ⎕←⎕tsync 3     ⍝ context requires result
VALUE ERROR
 
      ⎕←⎕tsync {}&amp;0  ⍝ non-result-returning fn: no result.
VALUE ERROR</pre><p>Coding would normally avoid such an inconvenient <tt>VALUE ERROR</tt> either by arranging that the thread-spawning and <tt>⎕TSYNC</tt> were on the same line:</p><pre>      rslt ← ⎕TYSYNC myfn&amp;¨ argvec</pre><p>or</p><pre>      tnums←myfn&amp;¨ argvec ⋄ rslt←⎕TSYNC tnums</pre><p>or by error-trapping the <tt>VALUE ERROR</tt>.</p></body>
</html>