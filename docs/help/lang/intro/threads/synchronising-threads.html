<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../../help.css"></head>
<body><h3>Synchronising Threads</h3><p>Threads may be synchronised using <span class="Italic">tokens</span> and a <span class="Italic">token pool</span>.</p><p>An application can synchronise its threads by having one thread add tokens into the pool whilst other threads wait for tokens to become available and retrieve them from the pool.</p><p>Tokens possess two separate attributes, a <span class="Italic">type</span> and a <span class="Italic">value</span>.</p><p>The <span class="Italic">type</span> of a token is a positive or negative integer scalar. The <span class="Italic">value</span> of a token is any arbitrary array that you might wish to associate with it.</p><p>The token pool may contain up to 2*31 tokens; they do not have to be unique neither in terms of their types nor of their values.</p><p>The following system functions are used to manage the token pool:</p><table><col style="width: 2cm;"></col><col></col><tr><td><tt>⎕TPUT</tt></td><td>Puts tokens into the pool.</td></tr><tr><td><tt>⎕TGET</tt></td><td>If necessary waits for, and then retrieves some tokens from the pool.</td></tr><tr><td><tt>⎕TPOOL</tt></td><td>Reports the types of tokens in the pool</td></tr><tr><td><tt>⎕TREQ</tt></td><td>Reports the token requests from specific threads</td></tr></table><p>A simple example of a thread synchronisation requirement occurs when you want one thread to reach a certain point in processing before a second thread can continue. Perhaps the first thread performs a calculation, and the second thread must wait until the result is available before it can be used.</p><p>This can be achieved by having the first thread put a specific type of token into the pool using <tt>⎕TPUT</tt>. The second thread waits (if necessary) for the new value to be available by calling <tt>⎕TGET</tt> with the same token type.</p><p>Notice that when <tt>⎕TGET</tt> returns, the specified tokens are <span class="Italic">removed</span> from the pool. However, <span class="Italic">negative</span> token types will satisfy an infinite number of requests for their positive equivalents.</p><p>The system is designed to cater for more complex forms of synchronisation. For example, a <span class="Italic">semaphore</span> to control a number of resources can be implemented by keeping that number of tokens in the pool. Each thread will take a token while processing, and return it to the pool when it has finished.</p><p>A second complex example is that of a <span class="Italic">latch</span> which holds back a number of threads until the coast is clear. At a signal from another thread, the latch is opened so that all of the threads are released. The latch may (or may not) then be closed again to hold up subsequently arriving threads. A practical example of a latch is a ferry terminal.</p></body>
</html>