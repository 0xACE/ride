<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../../help.css"></head>
<body><h3>Monadic Example</h3><p>In the following example, <tt>DomesticParrot</tt> is derived from <tt>Parrot</tt> which is derived from <tt>Bird</tt>. They all share the Field <tt>Species</tt> (inherited from <tt>Bird</tt>) but only a <tt>DomesticParrot</tt> has a Field <tt>Name</tt>. Each of the 3 Classes has its own Constructor called <tt>egg</tt>.</p><pre>:Class Bird
    :Field Public Species
    ∇ egg spec
      :Access Public Instance
      :Implements Constructor
      Species←spec
    ∇
    ...
:EndClass ⍝ Bird
 
:Class Parrot: Bird
    ∇ egg species
      :Access Public Instance
      :Implements Constructor :Base 'Parrot: ',species
    ∇
    ...
:EndClass ⍝ Parrot
 
:Class DomesticParrot: Parrot
    :Field Public Name
    ∇ egg(name species)
      :Access Public Instance
      :Implements Constructor :Base species
      ⎕DF Name←name
    ∇
    ...
:EndClass ⍝ DomesticParrot
 </pre><p class="pagebreakafter"> </p><pre>
      pol←⎕NEW DomesticParrot('Polly' 'Scarlet Macaw')
      pol.Name
Polly
      pol.Species
Parrot: Scarlet Macaw</pre><h4>Explanation</h4><p><tt>⎕NEW</tt> creates the new instance and runs the Constructor <tt>DomesticParrot.egg</tt>. The <tt>egg</tt> header splits the argument into two items <tt>name</tt> and <tt>species</tt>. As soon as the line:</p><pre>:Implements Constructor :Base species</pre><p>is encountered, <tt>⎕NEW</tt> calls the Base Class constructor <tt>Parrot.egg</tt>, passing it the result of the expression to the right, which in this case is simply the value in <tt>species</tt>.</p><p><tt>Parrot.egg</tt> starts to execute and as soon as the line:</p><pre>:Implements Constructor :Base 'Parrot: ',species</pre><p>is encountered, <tt>⎕NEW</tt> calls <span class="Italic">its</span> Base Class constructor <tt>Bird.egg</tt>, passing it the result of the expression to the right, which in this case is the character vector <tt>'Parrot: '</tt> catenated with the value in <tt>species</tt>.</p><p><tt>Bird.egg</tt> assigns its argument to the Public Field <tt>Species</tt>.</p><p>At this point, the State Indicator would be:</p><pre>       )SI
[#.[Instance of DomesticParrot]] #.Bird.egg[3]*
[constructor]
:base
[#.[Instance of DomesticParrot]] #.Parrot.egg[2]
[constructor]
:base
[#.[Instance of DomesticParrot]] #.DomesticParrot.egg[2]
[constructor]</pre><p><tt>Bird.egg</tt> then returns to <tt>Parrot.egg</tt> which returns to <tt>DomesticParrot.egg</tt>.</p><p>Finally, <tt>DomesticParrot.egg[3]</tt> is executed, which establishes Field <tt>Name</tt> and the Display Format (<tt>⎕DF</tt>) for the instance.</p></body>
</html>