<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../help.css"></head>
<body><h2><a name="SearchFunctionsAndHashTables"></a>Search Functions and Hash Tables</h2><p>Primitive dyadic <span class="Italic">search</span> functions, such as <tt>⍳</tt> (index of) and <tt>∊</tt> (membership) have a <span class="Italic">principal</span> argument in which items of the other <span class="Italic">subject</span> argument are located.</p><p>In the case of <tt>⍳</tt>, the principal argument is the one on the left and in the case of <tt>∊</tt>, it is the one on the right. The following table shows the principal (P) and subject (s) arguments for each of the functions.</p><table><tr><td><tt>P ⍳ s</tt></td><td>Index of</td></tr><tr><td><tt>s ∊ P</tt></td><td>Membership</td></tr><tr><td><tt>s ∩ P</tt></td><td>Intersection</td></tr><tr><td><tt>P ∪ s</tt></td><td>Union</td></tr><tr><td><tt>s ~ P</tt></td><td>Without</td></tr><tr><td><tt>P {(↓⍺)⍳↓⍵} s</tt></td><td>Matrix Iota (idiom)</td></tr><tr><td><tt>P∘⍋ and P∘⍒</tt></td><td>Sort</td></tr></table><p>The Dyalog APL implementation of these functions already uses a technique known as <span class="Italic">hashing</span> to improve performance over a simple linear search. (Note that <tt>⍷</tt> (find) does not employ the same hashing technique, and is excluded from this discussion.)</p><p>Building a <span class="Italic">hash table </span>for the principal argument takes a significant time but is rewarded by a considerably quicker search for each item in the subject. Unfortunately, the hash table is discarded each time the function completes and must be reconstructed for a subsequent call (even if its principal argument is identical to that in the previous one).</p><p>For optimal performance of <span class="Italic">repeated</span> search operations, the hash table may be retained between calls, by binding the function with its principal argument using the primitive <tt>∘</tt> (compose) operator. The retained hash table is then used directly whenever this monadic derived function is applied to a subject argument.</p><p>Notice that retaining the hash table pays off only on a second or subsequent application of the derived function. This usually occurs in one of two ways: either the derived function is named for later (and repeated) use, as in the first example below or it is applied repeatedly as the operand of a primitive or defined operator, as in the second example.</p><h4>Example: naming a derived function.</h4><pre>      words←'red' 'ylo' 'grn' 'brn' 'blu' 'pnk' 'blk'
 
      find←words∘⍳                 ⍝ monadic find function
      find'blk' 'blu' 'grn' 'ylo'  ⍝ 
7 5 3 2
      find'grn' 'brn' 'ylo' 'red'  ⍝ fast find
3 4 2 1</pre><h4>Example: repeated application by (<tt>¨</tt>) each operator.</h4><pre>      ∊∘⎕A¨'This' 'And' 'That'
 1 0 0 0  1 0 0  1 0 0 0</pre><script src="../../../help.js"></script></body>
</html>