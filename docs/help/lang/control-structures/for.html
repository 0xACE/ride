<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../help.css"></head>
<body><h2><tt>:For var :In[Each] aexp</tt>For Statement</h2><p><span class="MCPopup"><a href="javascript:void(0);" onclick="FMCPopup( event, this ); return false;" class="MCPopupSpot">Formal Definition</a></span></p><h4>Single Control Variable</h4><p>The <tt>:For</tt> loop is used to execute a block of code for a series of values of a particular control variable.  For example, the following would execute lines <tt>[2-3]</tt> successively for values of <tt>I</tt> from 3 to 5 inclusive:</p><pre>[1]   :For I :In 3 4 5
[2]       expr1 I
[3]       expr2 I
[4]   :EndFor</pre><p>The way a <tt>:For</tt> loop operates is as follows.  On encountering the <tt>:For</tt>, the expression to the right of <tt>:In</tt> is evaluated and the result stored.  This is the <span class="Italic">control array</span>.  The <span class="Italic">control variable</span>, named to the right of the <tt>:For</tt>, is then assigned the first value in the control array, and the code between <tt>:For</tt> and <tt>:EndFor</tt> is executed.  On encountering the <tt>:EndFor</tt>, the control variable is assigned the next value of the control array and execution of the code is performed again, starting at the first line after the <tt>:For</tt>.  This process is repeated for each value in the control array.</p><p>Note that if the control array is empty, the code in the <tt>:For</tt> structure is not executed.  Note too that the control array may be any rank and shape, but that its elements are assigned to the control variable in ravel order.</p><p>The control array may contain any type of data.  For example, the following code resizes (and compacts) all your component files</p><pre>[1]   :For FILE :In (↓⎕FLIB '')~¨' '
[2]       FILE ⎕FTIE 1
[3]       ⎕FRESIZE 1
[4]       ⎕FUNTIE 1
[5]   :EndFor</pre><p>You may also nest <tt>:For</tt> loops.  For example, the following expression finds the timestamp of the most recently updated component in all your component files.</p><pre>[1]   TS←0
[2]   :For FILE :In (↓⎕FLIB '')~¨' '
[3]       FILE ⎕FTIE 1
[4]       START END←2⍴⎕FSIZE 1
[5]       :For COMP :In (START-1)↓⍳END-1
[6]           TS⌈←¯1↑⎕FREAD FILE COMP
[7]       :EndFor
[8]       ⎕FUNTIE 1
[9]   :EndFor</pre><h4>Multiple Control Variables</h4><p>The <tt>:For</tt> control structure can also take multiple variables. This has the effect of doing a strand assignment each time around the loop. </p><p>For example <tt>:For a b c :in (1 2 3)(4 5 6)</tt>, sets <tt>a b c←1 2 3</tt>, first time around the loop and <tt>a b c←4 5 6</tt>, the second time. </p><p>Another example is <tt>:For i j :In ⍳⍴Matrix</tt>, which sets <tt>i </tt>and <tt>j</tt> to each row and column index of <tt>Matrix</tt>.</p><h4>:InEach Control Word</h4><pre>      :For var ... :InEach value ...</pre><p>In a <tt>:For</tt> control structure, the keyword <tt>:InEach</tt> is an alternative to <tt>:In</tt>.</p><p>For a single control variable, the effect of the keywords is identical but for multiple control variables the values vector is inverted.</p><p>The distinction is best illustrated by the following equivalent examples:</p><pre>      :For a b c :In (1 2 3)(3 4 5)(5 6 7)(7 8 9)
          ⎕←a b c
      :EndFor
 
      :For a b c :InEach (1 3 5 7)(2 4 6 8)(3 5 7 9)
           ⎕←a b c
      :EndFor</pre><p>In each case, the output from the loop is:</p><pre>1 2 3
3 4 5
5 6 7
7 8 9</pre><p>Notice that in the second case, the number of items in the values vector is the same as the number of control variables. A more typical example might be.</p><pre>      :For a b c :InEach avec bvec cvec
          ...
      :EndFor</pre><p>Here, each time around the loop, control variable <tt>a</tt> is set to the next item of <tt>avec</tt>, <tt>b</tt> to the next item of <tt>bvec</tt> and <tt>c</tt> to the next item of <tt>cvec</tt>.</p><script src="../../../help.js"></script></body>
</html>