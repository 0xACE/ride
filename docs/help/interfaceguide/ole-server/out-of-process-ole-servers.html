<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../help.css"></head>
<body><h2><a name="Out_OF_Process_OLE_Servers"></a>Out-of-process OLE Servers</h2><h4><a name="Exporting"></a>Exporting</h4><p>When you use File/Export to create an <span class="Italic">out-of-process</span> OLE Server, the following steps are performed.</p><p>APL first creates a single Type Library File that describes all of the OLEServer objects in the workspace. It then registers your OLE Server by updating the Windows Registry with, among other things, the names and ClassIDs of your workspace and Type Library file. </p><p class="fighead">Note that the type information is taken from your active workspace and not the saved workspace. It is up to you to ensure that your saved workspace (which will actually be used when the OLE Server is invoked) is kept in step. </p><p>For example, if you were subsequently to remove the OLEServer objects from your workspace and re-save it, or save a completely different workspace with the same pathname, your OLE Server would fail to start because the Type Library and Registry and no longer synchronised with your workspace.</p><h4><a name="Execution"></a>Execution</h4><p>An out-of-process OLE Server is implemented by a separate Dyalog APL process (DYALOG.EXE or DYALOGRT.EXE) that loads your workspace when it starts.</p><p>If an out-of-process OLE Server, that is bound with the <span class="Italic">run-time</span> Dyalog APL program, generates an untrapped error, an OLE Automation error will be reported.</p><p>If an out-of-process OLE Server, that is bound with the <span class="Italic">development</span> Dyalog APL program, generates an untrapped error, the APL Session will appear and you can use it to debug the problem and continue. In previous versions of Dyalog APL, the visibility of the APL Session for debugging was controlled by the ShowSession property. Setting ShowSession to 1 will cause the Session to be displayed immediately, when the OLE Server is started. However, setting ShowSession to 0 will not prevent the Session from appearing if an untrapped APL error occurs.<span class="span_10">Registering and Unregistering</span></p><p>During development, an out-of-process OLE Server is automatically registered when you create it using <span class="Italic">File/Export</span>.</p><p>An out-of-process OLEServer may also be registeredÂ  by calling its OLERegister method. This performs the same tasks as <span class="Italic">File/Export</span>, but without any user-interaction.</p><p>OLERegister is the recommended way to install an <span class="Italic">out-of-process</span> OLEServer on a target computer as a run-time application.</p><p>An out-of-process OLEServer may be unregistered by calling its OLEUnRegister method. </p><h4><a name="Registry_Entries"></a>Registry Entries</h4><p>This section describes the entries that are written into the Windows Registry when APL registers an <span class="Italic">out-of-process</span> OLEServer.</p><p>All registry entries are written as sub-keys of the primary key <span class="Code">HKEY_LOCAL_MACHINE\SOFTWARE\Classes</span> of which <span class="Code">HKEY_CLASSES_ROOT</span> is an alias. Four separate entries are created, although only the first of these applies to top-level OLEServers.</p><ol><li value="1">A sub-key named <b>dyalog.xxxx</b> where <b>xxxx</b> is the name of the OLEServer. This has a sub-key named <b>CLSID</b> whose <span class="Italic">Default</span> value is a GUID corresponding to the ClassID property of the OLEServer.</li><li value="2">A sub-key named <b>CLSID\xxxx</b> where <b>xxxx</b> is the GUID corresponding to the value of the ClassID property of the OLEServer. The <span class="Italic">Default</span> value of this sub-key is the name of the OLEServer, and the sub-key itself contains sub-keys, namely <b>DyalogDispInterface</b>,<b> DyalogEventInterface, InProcHandler32</b>, <b>LocalServer32</b>, <b>ProgID</b>, <b>TypeLib</b>, and <b>VersionIndependentProgID</b>.
					<ol class="Level2"><li value="1"><b>DyalogDispInterface</b> and <b>DyalogEventInterface</b> have their <span class="Italic">Default</span> values set to the GUID for the Interface entry (see Paragraph 4). This GUID is generated internally by the registration of the Type Library.</li><li value="2"><b>InProcHandler32</b> has the <span class="Italic">Default</span> value "OLE32.DLL".</li><li value="3"><b>LocalServer32</b> has its <span class="Italic">Default</span> value set to the command line that is required to start the OLEServer. This is the full path-name of the appropriate DYALOG.EXE or DYALOGRT.EXE followed by the full path-name of the corresponding workspace plus any options that were specified in the <span class="Italic">Create bound file</span> dialog box.</li><li value="4"><b>ProgID</b> has its <span class="Italic">Default</span> value set to "dyalog.xxxx" where "xxxx" is the name of the OLEServer.</li><li value="5"><b>TypeLib</b> has its <span class="Italic">Default</span> value set to the GUID corresponding to the TypeLibID property of the OLEServer.</li><li value="6"><b>VersionIndependentProgID</b> has its <span class="Italic">Default</span> value set to "dyalog.xxxx" where "xxxx" is the name of the OLEServer (same as <b>ProgID</b>).</li><li value="7">Note that for a sub-object (an OLEServer that is a child of another OLEServer) only the <b>InProcHandler32</b> key is required, although the other entries are created and are in fact redundant.</li></ol></li><li value="3">A sub-key named <b>TypeLib\xxxx</b> where <b>xxxx</b> is the GUID corresponding to the value of the TypeLib property of the OLEServer. This contains a sub-key named <b>1.0</b> (which refers to its version number). The <span class="Italic">Default</span> value of <b>1.0</b> is "Type Library for xxxx" where "xxxx" is the name of the OLEServer. <b>1.0</b> contains three further sub-keys named <b>0</b>, <b>FLAGS</b> and <b>HELPDIR</b>.</li><ol class="Level2"><li value="1"><b>0</b> (this identifies the language id; 0 refers to <span class="Italic">all </span>languages) contains a sub-key named <b>win32</b> whose <span class="Italic">Default</span> value is the full path-name of the Type Library file associated with the OLE object; i.e. the value of the TypeLibFile property of the OLEServer.</li><li value="2"><b>FLAGS</b> has a <span class="Italic">Default</span> value of "0".</li><li value="3"><b>HELPDIR</b> has its <span class="Italic">Default</span> value set to the full path-name of the directory in which the corresponding workspace is saved.</li></ol><li class="li_1" value="4">Sub-keys named <b>Interface\xxxx</b> where <b>xxxx</b> is the GUID referenced by the value of <b>DyalogDispInterface</b> and <b>DyalogEventInterface</b> described in paragraph 2. The <span class="Italic">Default</span> values of these sub-keys is "xxxxdisp" where "xxxx" is the name of the OLEServer. You may identify the correct <b>Interface</b> sub-key by searching the registry for this string. It has three sub-keys named <b>ProxyStubClsid</b>, <b>ProxyStubClsid32</b>, and <b>TypeLib</b>.</li><ol class="Level2"><li value="1"><b>ProxyStubClsid</b> has a <span class="Italic">Default</span> value of a GUID that references an interface of type PSDispatch.)</li><li value="2"><b>ProxyStubClsid32</b> (same as <b>ProxyStubClsid</b>).</li><li value="3"><b>TypeLib</b> has two values. Its <span class="Italic">Default</span> value is the GUID identified by the TypeLib property of the OLEServer object, or, for a child OLEServer, the TypeLib property if its parent OLEServer. Its <span class="Italic">Version</span> value is "1.0".</li></ol></ol><script src="../../../help.js"></script></body>
</html>