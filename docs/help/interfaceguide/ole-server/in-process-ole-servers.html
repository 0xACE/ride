<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../help.css"></head>
<body><h2><a name="In_Process_OLE_Servers"></a>In-process OLE Servers</h2><h4><a name="Exporting"></a>Exporting</h4><p>When you use File/Export to create an <span class="Italic">in-process</span> OLE Server, the following steps are performed.</p><p>APL first saves your workspace to a <span class="Italic">temporary</span> file. Then it creates a <span class="Italic">temporary</span> Type Library File that describes each of the OLEServer objects in the workspace. Next, it creates a Dynamic Link Library (DLL) file (whose name defaults to the name of your workspace but with a .DLL extension) by mergingÂ  the workspace saved in the temporary file with the file OCXSTUB.DLL. Finally, it registers your OLE Server by updating the Windows Registry. Your OLE Server DLL is self-contained and is independent of your workspace. The temporary files are then deleted.</p><h4><a name="Execution"></a>Execution</h4><p>In-process OLEServers are hosted (executed) by the Dyalog APL DLL. If you export your OLE Server with <span class="Italic">Runtime application</span> checked, it will be bound with the run-time version, If this checkbox is cleared, your OLE Server will be bound by the development version.</p><p>If an in-process OLE Server, that is bound with the run-time Dyalog APL DLL generates an untrapped error, an OLE Automation error will be reported.</p><p>If an in-process OLE Server, that is bound with the development Dyalog APL DLL generates an untrapped error, the APL Session will appear and you can use it to debug the problem and continue. Note that at this point, the development DLL will load your Session file so that all of your session tools are available during debugging. If your Session file runs any initialisation code that references external files, remember that this code will be executed in the current working directory of the host process.</p><p>For further details, see <span class="Italic">User Guide, Chapter 2</span>.</p><h4><a name="Registering_UnRegistering"></a>Registering and Unregistering</h4><p>During development, an in-process OLE Server is automatically registered when you create it using <span class="Italic">File/Export</span>.</p><p>The Windows utility REGSVR32.EXE should be used to register an <span class="Italic">in-process</span> OLE Server independently, or to install a runtime in-process OLE Server on a target computer. For example:</p><pre class="Code">C:\Dyalog101&gt;regsvr32 mysvr.dll</pre><p>REGSVR32 should also be used (with the <span class="Italic">/u</span> flag) to un-register an in-process OLE Server. For example:</p><pre class="Code">C:\Dyalog101&gt;regsvr32 /u mysvr.dll</pre><p>Note that in both cases, REGSVR32 actually starts the OLE Server. This in turn loads the appropriate Dyalog APL DLL. If you are using the development DLL, note that if your session start-up code fails for any reason, the REGSVR32 process will hang and have to be terminated using the Task Manager.</p></body>
</html>