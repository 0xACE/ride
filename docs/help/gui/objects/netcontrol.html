<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../help.css"></head>
<body><h2><tt>Object</tt>NetControl</h2><table class="GUIMembers"><tr><td class="SpacedPlain"><span class="MCPopup"><a href="javascript:void(0);" onclick="FMCPopup( event, this ); return false;" class="MCPopupSpot">Parents</a></span></td><td class="SpacedPlain"><span class="MCPopup"><a href="javascript:void(0);" onclick="FMCPopup( event, this ); return false;" class="MCPopupSpot">Children</a></span></td><td class="SpacedPlain"><span class="MCPopup"><a href="javascript:void(0);" onclick="FMCPopup( event, this ); return false;" class="MCPopupSpot">Properties</a></span></td></tr></table><table class="GUIMembers"><tr><td class="SpacedPlainTitle">Purpose:</td><td class="SpacedPlain">The NetControl object provides the means to instantiate a .Net control
        in the Dyalog GUI.</td></tr></table><p class="Bold">Description</p><p>In principle, you may use the NetControl to embed any class that derives from System.Windows.Forms.Control (from system.windows.forms.dll), including derived classes written in Dyalog APL.</p><p>To load a particular .Net control, the appropriate .Net Assembly must be specified in <tt>⎕USING</tt>; otherwise the expression will cause a <tt>LIMIT ERROR</tt>. For example, to load one of the standard .Net controls:</p><pre>⎕USING,←⊂'System.Windows.Forms,system.windows.forms.dll'</pre><p>The <a href="../props/classname.html"> ClassName</a> property specifies the name of the .Net control to be instantiated and to which the new object named by the left argument of <tt>⎕WC</tt> is to be connected.
<a href="../props/classname.html"> ClassName</a> may only be specified by <tt>⎕WC</tt>.</p><p>Once you have created an instance of a particular NetControl, the properties, events and methods it supports may be obtained using <tt>⎕NL</tt>. These are the properties, events and methods defined for the control by its author. The "Dyalog" properties listed above, are not reported by
<tt>⎕NL</tt>, but take precedence over (i.e. mask) any members of the same name that may be exposed by the class itself.</p><p>The following example illustrates the use of the Button class. In this case, the FlatStyle property of the button is set to "Popup". This gives the button a flat appearance until the mouse is hovered over it, when its appearance it changes to 3-dimensional.</p><p class="pagebreakafter"> </p><pre class="APLCodeSmall">       ⎕USING←'System'
       ⎕USING,←⊂'System.Windows.Forms,system.windows.forms.dll'
       ⎕USING,←⊂'System.Drawing,system.drawing.dll'
       an←⎕NEW FontFamily(⊂'Arial')
       myfont←⎕NEW Font(an 24 FontStyle.Bold GraphicsUnit.Point)

       'f'⎕WC'Form'('Coord' 'Pixel')('Size' 120 200)
       f.Caption←'NetControl'
       'f.l'⎕WC'Label' 'Button with FlatStyle=Popup'(2 2)

       'f.b'⎕WC'NetControl' 'Button'('Size' 60 160)

       f.b.⎕NL ¯2
AutoSizeMode DialogResult AutoEllipsis AutoSize BackColor FlatStyle FlatAppearance...

       f.b.⎕NL ¯3
BeginInvoke BringToFront Contains CreateControl CreateGraphics CreateObjRef Dispose DoDragDrop...

       f.b.⎕NL¯8
DoubleClick MouseDoubleClick AutoSizeChanged ImeModeChanged BackColorChanged...

       f.b.Text←'Popup'
       f.b.Font←myfont

       f.b.(FlatStyle←FlatStyle.Popup)
</pre><table><tr><th class="Left">Normal appearance (Flat)</th><th class="Left">	Appearance when mouse over</th></tr><tr><td><img src="../images/netcontrol1.jpg" /></td><td><img src="../images/netcontrol2.jpg" /></td></tr></table><p>In most cases, you may use a NetControl in the cells of a <a href="grid.html"> Grid</a> object. Unless you specify otherwise, using the
<a href="../props/inputproperties.html"> InputProperties</a> property of the <a href="grid.html"> Grid</a>, the default property of the NetControl will be associated with the corresponding element of Values. The following example illustrates the use of a TextBox control. In this example, the CharacterCasing property of the TextBox is set to Upper, causing all text to be converted to upper-case.</p><pre class="APLCodeSmall">       ⎕USING←'System'
       ⎕USING,←⊂'System.Windows.Forms,system.windows.forms.dll'
       ⎕USING,←⊂'System.Drawing,system.drawing.dll'
       an←⎕NEW FontFamily(⊂'Arial Narrow')
       myfont←⎕NEW Font(an 11 FontStyle.Bold GraphicsUnit.Point)
       'f'⎕WC'Form'('Coord' 'Pixel')('Size' 130 500)
       f.Caption←'Grid using .Net TextBox Control'
       'f.g'⎕WC'Grid'('Posn' 0 0)f.Size
       f.g.(ShowInput TitleWidth)←1 0
       'f.g.tb'⎕WC'NetControl' 'TextBox'
       f.g.tb.Font←myfont
       f.g.tb.(CharacterCasing←CharacterCasing.Upper)
       f.g.Input←'f.g.tb'
       wds←'All' 'TeXt' 'Is' 'Changed' 'to' 'Upper' 'casE'
       wds,←'ακομα' 'kai' 'τα' 'Ελληνικα'
       f.g.Values←5 5⍴wds</pre><p><img src="../images/netcontrol3.jpg" /></p><p>Implementation note: The instance of the .Net control is actually placed inside an instance of the .Net class System.Windows.Forms.ContainerControl.This ContainerControl is then embedded in the Dyalog parent, such as a
<a href="form.html">Form</a>. This "extra level" should have no affect on how the control is used or on how it behaves.
</p></body>
</html>