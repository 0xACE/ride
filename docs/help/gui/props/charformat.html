<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../help.css"></head>
<body><h2><tt>Property</tt>CharFormat</h2><table class="GUIMembers"><tr><td class="SpacedPlainTitle">Applies To:</td><td class="SpacedPlain"><a href="../objects/richedit.html">RichEdit</a></td></tr></table><p class="Bold">Description</p><p>The CharFormat property describes or applies formatting to the currently selected text in a <a href="../objects/richedit.html">RichEdit</a> object. If the selection is empty, it reports or specifies the default character formatting for the object. It is a 5-element nested array structured as follows:</p><table><tr><td><tt>[1]</tt></td><td> A vector of character vectors which describes the text attributes and is comprised of the following keywords:<table><tr><td class="DyalogPlain">'Autocolour'   </td><td>default colour (Windows text colour)</td></tr><tr><td class="DyalogPlain">'Bold'</td><td>bold text</td></tr><tr><td class="DyalogPlain">'Italic'   </td><td>bold text</td></tr><tr><td class="DyalogPlain">'Underline'   </td><td>underlined</td></tr><tr><td class="DyalogPlain">'StrikeOut'   </td><td>line through text</td></tr><tr><td class="DyalogPlain">'Protected'   </td><td>protected (read-only) text</td></tr></table></td></tr><tr><td><tt>[2]</tt></td><td> A character vector that specifies the face name of the font used to draw the text</td></tr><tr><td><tt>[3]</tt></td><td> Character height in <span class="MCPopup"><a href="javascript:void(0);" onclick="FMCPopup( event, this ); return false;" class="MCPopupSpot">Twips</a></span>.</td></tr><tr><td><tt>[4]</tt></td><td>Text colour. A single integer or an enclosed vector of 3 RGB values. The default is 0 which implies the standard Windows text colour.</td></tr><tr><td><tt>[5]</tt></td><td>Integer specifying the vertical offset of the character from the base line in <span class="MCPopup"><a href="javascript:void(0);" onclick="FMCPopup( event, this ); return false;" class="MCPopupSpot">Twips</a></span>. This is used to specify superscript (positive offset) and subscript (negative offset) symbols. The default value is 0.</td></tr></table><p>When you set the character format using <tt>⎕WC</tt> or <tt>⎕WS</tt> the following rules apply.</p><p>If you just want to set a single text attribute (element 1) you may specify a simple vector, for example <tt>(⎕WS 'CharFormat' 'Protected')</tt> is valid and will add the protected text attribute to the current set of text attributes.</p><p>To unset a text attribute (element 1) you must insert the tilde (~) character before the name of the attribute. For example, the expression <tt>(⎕WS 'CharFormat' '~Bold')</tt> will turn the bold text attribute off.</p><p>You need only specify the number of elements required, but you must insert proper values for the elements you wish to remain unaltered. However, you may use <tt>''</tt> in the first element to leave the text attributes unchanged.</p><p>If there is no text selected, CharFormat specifies the <span class="Italic">default</span> character format, i.e. the format that will be used to draw the next (and subsequent) characters that the user enters. If there <span class="Italic">is</span> text selected it specifies the format of the selected block of text. If the format is not strictly homogeneous, <tt>⎕WG</tt> may report the format of the first character in the selected block, or, if the block contains characters which use completely different fonts, the result of <tt>(⎕WG 'CharFormat')</tt> will be empty.</p><p><tt>(⎕WS 'CharFormat' ...)</tt> will set the format of the currently selected block of text. To set the format of an arbitrary block of text you must select it first using <tt>(⎕WS 'SelText' ...)</tt>.</p></body>
</html>