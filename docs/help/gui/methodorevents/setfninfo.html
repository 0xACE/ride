<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../help.css"></head>
<body><h2><tt>Method 545</tt>SetFnInfo</h2><table class="GUIMembers"><tr><td class="SpacedPlainTitle">Applies To:</td><td class="SpacedPlain"><a href="../objects/activexcontrol.html">ActiveXControl</a></td><td class="SpacedPlain"><a href="../objects/oleserver.html">OLEServer</a></td></tr></table><p class="Bold">Description</p><p>This method is used to describe an APL function that is to be exported as a method, a Property Get Function, or a Property Put Function of an <a href="../objects/activexcontrol.html">ActiveXControl</a> or <a href="../objects/oleserver.html">OLEServer</a> object.</p><p>An exported function must be a niladic or monadic defined function (dynamic functions and derived functions are not allowed) and may optionally return a result. Ambivalent functions (functions with optional left argument) are allowed, but will be called monadically by the host application.</p><p>COM syntax differs from APL syntax in many ways and the SetFnInfo method is required to declare an APL function to COM in terms that COM understands. In particular, although monadic APL functions take just one argument, COM functions may take several parameters, and some may be optional.</p><p>A function exported by SetFnInfo will be called by a host application with the number of parameters that SetFnInfo has described. The argument received when the function is called by a host application, will be a nested vector of this length.</p><p>The argument to SetFnInfo is a 2, 3 or 4-element array as follows:</p><table><tr><td><tt>[1]</tt></td><td>Function name</td><td>character vector</td></tr><tr><td><tt>[2]</tt></td><td>Function info</td><td>nested array (see below)</td></tr><tr><td><tt>[3]</tt></td><td>Help ID</td><td>integer</td></tr><tr><td><tt>[4]</tt></td><td>Function type</td><td>integer</td></tr><tr><td><tt>[5]</tt></td><td>Property name</td><td>character vector</td></tr></table><h4>Function info</h4><p>This specifies an optional help string which describes what the function does, the data type of the result (if any) and the names and data types of its arguments.</p><p>If the function syntax is fully described, each element of <span class="Italic">Function Info</span> is a 2-element vector of character vectors. The first element contains the help string and the <span class="MCPopup"><a href="javascript:void(0);" onclick="FMCPopup( event, this ); return false;" class="MCPopupSpot">COM data type</a></span> of the function's result. Subsequent elements contain the name and <span class="MCPopup"><a href="javascript:void(0);" onclick="FMCPopup( event, this ); return false;" class="MCPopupSpot">COM data type</a></span> of each parameter.</p><p>However, both the help string and the names of the parameters are optional and may be omitted. If so, one or more elements of <span class="Italic">Function Info</span> may be a simple character vector.</p><p>Consider a very basic function <tt>ADD</tt> in an <a href="../objects/activexcontrol.html">ActiveXControl</a> called <tt>F.dbase</tt>, that is designed to add a record to a personnel database. The database consists only of a list of names, ages and addresses.</p><p>Function <tt>ADD</tt> expects to be called with a name (character string), age (number) and address (character string), and returns a result 0 or 1 (Boolean) according to whether the record was successfully added. This function could be declared as follows:</p><pre>      HELP←'Adds a new record to the personnel database'
      SPEC←⊂(HELP 'VT_BOOL')      ⍝ Result is boolean     
      SPEC,←⊂('Name' 'VT_BSTR')   ⍝ 1st param called 'Name' is a string   
      SPEC,←⊂('Age' 'VT_I4')      ⍝ 2nd param called 'Age' is an integer  
      SPEC,←⊂('Address' 'VT_BSTR')⍝ 3rd param called 'Address' is a string

      F.dbase.SetFnInfo 'ADD' SPEC</pre><p>Alternatively, but much less helpfully, the function could be declared to take a single unnamed nested argument, leaving it to the host application programmer to guess at its structure :</p><pre>      SPEC←⊂('' 'VT_BOOL')              ⍝ No help string, result is boolean
      SPEC,←⊂('' 'VT_ARRAY OF VT_VARIANT') ⍝ Param is a nested array
      F.dbase.SetFnInfo 'ADD'SPEC</pre><h4>Help ID</h4><p>This is an integer value that identifies the help context id within the help file associated with the HelpFile property of the <a href="../objects/activexcontrol.html">ActiveXControl</a> object. The value <tt>¯1</tt> means that no help is provided. APL stores this information in the registry from where it may be retrieved by the host application.</p><h4>Function type</h4><p>This specifies the type of function being exported. This is an integer with one of the following values:</p><p>In both these last two cases, the name of the property, which is totally independent of the name of the APL function, is given as <span class="Italic">Property name</span>.</p><p>If omitted, the function type is <span class="Italic">method</span>.</p></body>
</html>