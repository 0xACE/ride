<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../help.css"></head>
<body><h2><tt>Event 161</tt>CellDown</h2><table class="GUIMembers"><tr><td class="SpacedPlainTitle">Applies To:</td><td class="SpacedPlain"><a href="../objects/grid.html">Grid</a></td></tr></table><p class="Bold">Description</p><p>If enabled, this event is reported when the user presses a mouse button down whilst over a cell in a <a href="../objects/grid.html">Grid</a>. The purpose of this event is to allow an application to display a pop-up <a href="../objects/menu.html">Menu</a> or a <a href="../objects/locator.html">Locator</a> over a cell in a <a href="../objects/grid.html">Grid</a> or to take some other special action.</p><p>The default action is to generate a <a href="cellmove.html">CellMove</a> event which will then position the user on the new cell. This action can be prevented by returning 0 from the callback function, in which case the normally ensuing <a href="cellmove.html">CellMove</a> event will not occur.</p><p>The event message reported as the result of <a href="../../lang/sysfns/dq.html"><tt>⎕DQ</tt></a>, or supplied as the right argument to your callback function, is an 9 element vector as follows :</p><table class="Event"><tr><td><tt>[1]</tt></td><td>Object</td><td>ref or character vector</td></tr><tr><td><tt>[2]</tt></td><td>Event</td><td><tt>'CellDown'</tt> or 161</td></tr><tr><td><tt>[3]</tt></td><td>Y</td><td>y-position of mouse (number)</td></tr><tr><td><tt>[4]</tt></td><td>X</td><td>x-position of mouse (number)</td></tr><tr><td><tt>[5]</tt></td><td>Button</td><td>button pressed (number)<br />1 = left button<br />2 = 
      right button<br />4 = middle button</td></tr><tr><td><tt>[6]</tt></td><td>Shift State</td><td>sum of shift key codes (number)<br />1 = Shift key 
      is down<br />2 = Ctrl key is down<br />4 = Alt key is down</td></tr><tr><td><tt>[7]</tt></td><td>Cell row</td><td>integer</td></tr><tr><td><tt>[8]</tt></td><td>Cell column</td><td>integer</td></tr><tr><td><tt>[9]</tt></td><td>Title index</td><td>integer</td></tr></table><p>The y and x position of the mouse are reported relative to the top-left corner of the <a href="../objects/grid.html">Grid</a>.</p><p>The cell row and column are <tt>⎕IO</tt> dependent </p><p>If the user clicks over a row <span class="Italic">title</span>, the value reported for the column is <tt>¯1</tt>, and the value reported for Title index is the index of that row title in <a href="../props/rowtitles.html">RowTitles</a>, or, if <a href="../props/rowtitles.html">RowTitles</a> is not defined, the row number. Column titles are handled in a similar fashion.</p><p>An application <b>can</b> position the user on a particular cell in a <a href="../objects/grid.html">Grid</a> by calling CellDown as a method, but it is recommended that a <a href="cellmove.html">CellMove</a> event is used instead.</p><script src="../../../help.js"></script></body>
</html>