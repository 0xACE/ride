<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../help.css"></head>
<body><h2><tt>Event 150</tt>CellChange</h2><table class="GUIMembers"><tr><td class="SpacedPlainTitle">Applies To:</td><td class="SpacedPlain"><a href="../objects/grid.html">Grid</a></td></tr></table><p class="Bold">Description</p><p>If enabled, this event is reported when the user changes the contents of a cell in a <a href="../objects/grid.html">Grid</a> object and then attempts to move to another cell or to another control outside the <a href="../objects/grid.html">Grid</a>.</p><p>The purpose of this event is to give the application the opportunity to perform additional validation before the update occurs (and to prevent it if necessary) or to update other cells in the <a href="../objects/grid.html">Grid</a> as a result of the change.</p><p>The default action for the CellChange event is to update the appropriate element of the <a href="../props/values.html">Values</a> property with the new data. This action can be disabled by returning 0 from the attached callback function. Notice however, that the user is not prevented from moving away from the cell. If you are using this event to perform additional validation and you require the user to correct the data before moving away, you must force the user back to the cell in question by generating a <a href="cellmove.html">CellMove</a> event.</p><p>The event message reported as the result of <a href="../../lang/sysfns/dq.html"><tt>⎕DQ</tt></a>, or supplied as the right argument to your callback function, is an 8-element vector as follows:</p><table class="Event"><tr><td><tt>[1]</tt></td><td>Object</td><td>ref or character vector</td></tr><tr><td><tt>[2]</tt></td><td>Event</td><td><tt>'CellChange'</tt> or 150</td></tr><tr><td><tt>[3]</tt></td><td>Cell row</td><td>integer</td></tr><tr><td><tt>[4]</tt></td><td>Cell column</td><td>integer</td></tr><tr><td><tt>[5]</tt></td><td>New data</td><td>number or character array</td></tr><tr><td><tt>[6]</tt></td><td>Object name</td><td>character vector (name of object to which the user has transferred focus)</td></tr><tr><td><tt>[7]</tt></td><td>New cell (row)</td><td>integer</td></tr><tr><td><tt>[8]</tt></td><td>New cell (column)</td><td>integer</td></tr></table><p>If the user moves to another cell in the <a href="../objects/grid.html">Grid</a>, the 6th element of the event message is the name of the <a href="../objects/grid.html">Grid</a> object and elements 7 and 8 specify the new cell address (<tt>⎕IO</tt> dependent).</p><p>If the user switches the input focus to another control or selects a <a href="../objects/menuitem.html">MenuItem</a>, the 6th element of the event message contains the name of that control or <a href="../objects/menuitem.html">MenuItem</a>. If the user switches to another application, the 6th element of the event message is an empty character vector. In all these cases, the 7th and 8th elements are 0.</p><p>The 5th element of the event message contains the data value that will be used to update the <a href="../props/values.html">Values</a> property. This will be numeric if the <a href="../props/fieldtype.html">FieldType</a> of the associated <a href="../objects/edit.html">Edit</a> object is Numeric, LongNumeric, Date, LongDate or Time. Otherwise, it will be a character array.</p><p>An application can update an individual cell in the Grid under program control by calling CellChange as a method. If so, the <span class="Italic">New object</span>, <span class="Italic">New cell row</span> and <span class="Italic">New cell column</span> parameters may be omitted.</p></body>
</html>