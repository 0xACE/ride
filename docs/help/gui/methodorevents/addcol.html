<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../help.css"></head>
<body><h2><tt>Event 153</tt>AddCol</h2><table class="GUIMembers"><tr><td class="SpacedPlainTitle">Applies To:</td><td class="SpacedPlain"><a href="../objects/grid.html">Grid</a></td></tr></table><p class="Bold">Description</p><p>If enabled, this event is reported by the <a href="../objects/grid.html">Grid</a> object if the user presses the Cursor Right key, and the current cell (<a href="../props/curcell.html">CurCell</a>) is within the last column on the <a href="../objects/grid.html">Grid</a>. The default action is to append a new column to the contents of the <a href="../objects/grid.html">Grid</a>. If you attach a callback function to this event and have it return a value of 0, a new column will not be appended to the <a href="../objects/grid.html">Grid</a>. Note that the event will not be generated unless the second element of the <a href="../props/autoexpand.html">AutoExpand</a> property is set to 1.</p><p>The event message reported as the result of <a href="../../lang/sysfns/dq.html"><tt>⎕DQ</tt></a>, or supplied as the right argument to your callback function, is a 3-element vector as follows :</p><table class="Event"><tr><td><tt>[1]</tt></td><td>Object</td><td>ref or character vector</td></tr><tr><td><tt>[2]</tt></td><td>Event</td><td><tt>'AddCol'</tt> or 153</td></tr><tr><td><tt>[3]</tt></td><td>Column number</td><td>number of the new column (integer).</td></tr></table><p> An application may insert a new column into a <a href="../objects/grid.html">Grid</a> by calling 
      AddCol as a method. The argument is a 1 to 7-element array as 
      follows:</p><table><tr><td><tt>[1]</tt></td><td>Column number:</td><td>number of the new column (integer)</td></tr><tr><td><tt>[2]</tt></td><td>Column title:</td><td>character vector or matrix</td></tr><tr><td><tt>[3]</tt></td><td>Column width:</td><td>integer</td></tr><tr><td><tt>[4]</tt></td><td>Undo flag</td><td>0 or 1</td></tr><tr><td><tt>[5]</tt></td><td>Resize flag</td><td>0 or 1</td></tr><tr><td><tt>[6]</tt></td><td>Title colour</td><td>negative integer or 3-element RGB vector</td></tr><tr><td><tt>[7]</tt></td><td>Line type</td><td>integer</td></tr></table><p>If you are using default column headings, <span class="Italic">Column title</span> will be ignored and the columns will be re-labelled with the default titles. If you have set <a href="../props/coltitles.html">ColTitles</a>, the title you specify will be inserted. If you omit <span class="Italic">Column title</span>, a blank title will be inserted.</p><p>Similarly, if you have not previously set <a href="../props/cellwidths.html">CellWidths</a>, <a href="../props/resizecols.html">ResizeCols</a>, <a href="../props/coltitlefcol.html">ColTitleFCol</a> or <a href="../props/collinetypes.html">ColLineTypes</a>, or if you have given them a scalar value, the corresponding parameter will be ignored. However, if you have specified <a href="../props/cellwidths.html">CellWidths</a>, <a href="../props/resizecols.html">ResizeCols</a>, <a href="../props/coltitlefcol.html">ColTitleFCol</a> or <a href="../props/collinetypes.html">ColLineTypes</a> to be a <span class="Italic">vector</span>, the number you specify in the corresponding parameter will be inserted into the appropriate property vector.</p><p>If you omit to specify <span class="Italic">Column width</span> for the new column, it will be assigned a default value; new values for the other properties default to 0. </p><p><span class="Italic">Undo flag</span> (default 1) specifies whether or not the addition of the new column may subsequently be undone by an <a href="undo.html">Undo</a> event.</p><p>To insert a new column before the first one, you must specify the <span class="Italic">Column number</span> as 1 (or 0 if <tt>⎕IO</tt> is 0). To add a new column after the last one, you may specify any number greater than the current number of columns. The data in the new column will be set to 0 if the <a href="../props/values.html">Values</a> property is numeric, or to an empty character vector otherwise.</p></body>
</html>