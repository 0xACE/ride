<!doctype html>
<html>
<head><meta charset="utf-8"><title></title><link rel="stylesheet" href="../../../help.css"></head>
<body><h2><tt>Event 195</tt>GridDropSel</h2><table class="GUIMembers"><tr><td class="SpacedPlainTitle">Applies To:</td><td class="SpacedPlain"><a href="../objects/grid.html">Grid</a></td></tr></table><p class="Bold">Description</p><p>If enabled, this event is reported when the user drag/drops a selected block of cells in the <a href="../objects/grid.html">Grid</a>. The default action is that the contents of the selected cells replace the values in the block of cells onto which they are dropped and this block now becomes selected.</p><p>You may disable the drag/drop facility entirely by setting the action code of the event to <tt>¯1</tt>. You may also disable an individual drag/drop operation by returning 0 from a callback function.</p><p>The event message reported as the result of <a href="../../lang/sysfns/dq.html"><tt>⎕DQ</tt></a>, or supplied as the right argument to your callback function, is a 6-element vector as follows :</p><table class="Event"><tr><td><tt>[1]</tt></td><td>Object</td><td>ref or character vector</td></tr><tr><td><tt>[2]</tt></td><td>Event</td><td><tt>'GridDropSel'</tt> or 195</td></tr><tr><td><tt>[3]</tt></td><td>Start</td><td>2-element integer vector containing the row, column address of the top left cell in the selected block</td></tr><tr><td><tt>[4]</tt></td><td>Size</td><td>2-element integer vector containing  the number of rows and columns in the selected block</td></tr><tr><td><tt>[5]</tt></td><td>Target</td><td>2-element integer vector containing the row/column address of the top left cell onto which the selected block is being dropped</td></tr><tr><td><tt>[6]</tt></td><td>Shift State</td><td>sum of shift key codes (number)<br />1 = Shift key 
      is down<br />2 = Ctrl key is down</td></tr><tr><td><tt>[7]</tt></td><td> Undo flag </td><td>0 or 1</td></tr><tr><td><tt>[8]</tt></td><td> Values</td><td>Matrix containing the values of the selected block of cells. This is the data that will replace the values in the target cells.</td></tr><tr><td><tt>[9]</tt></td><td> CellSet flags</td><td>Boolean Matrix containing the values of the <a href="../props/cellset.html">CellSet</a> property for the selected block of cells. This will replace the values of the <a href="../props/cellset.html">CellSet</a> property of the target cells.</td></tr></table><p>The shift state in element 6 is intended to allow the APL programmer to implement an  <span class="Italic">insert</span> operation instead of a <span class="Italic">copy</span>  or <span class="Italic">move</span> operation if required.</p><p>You may copy the contents of one block of cells to another by calling GridDropSel as a method. If so, you need only specify the <span class="Italic">Start</span>, <span class="Italic">Size</span> and <span class="Italic">Target</span> parameters. Note that the result block becomes selected.</p><p>The Undo flag is always 1 if the event was generated by the user.</p><script src="../../../help.js"></script></body>
</html>